<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Intelligence MVP</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 16px;
        }

        .container {
            width: min(1500px, 96vw);
            margin: 24px auto;
            background: #fff;
            border-radius: 16px;
            padding: 32px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.18);
        }

        h1 {
            color: #333;
            margin-bottom: 16px;
            text-align: center;
            font-size: 24px;
        }

        .input-section {
            margin-bottom: 12px;
            position: relative;
        }

        .search-note {
            margin-top: 8px;
            font-size: 12px;
            color: #6b7280;
            text-align: center;
        }

        .input-wrapper {
            display: flex;
            gap: 0;
            position: relative;
            align-items: center;
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            transition: border-color 0.3s, box-shadow 0.3s;
        }

        .input-wrapper:focus-within {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .search-icon-wrapper {
            padding: 0 12px;
            display: flex;
            align-items: center;
            color: #9ca3af;
        }

        .search-icon {
            font-size: 18px;
        }

        input[type="text"] {
            flex: 1;
            padding: 15px 15px 15px 0;
            font-size: 16px;
            border: none;
            border-radius: 8px;
            transition: none;
        }

        input[type="text"]:focus {
            outline: none;
        }

        .autocomplete-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            margin-top: 8px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            max-height: 400px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }

        .autocomplete-dropdown.active {
            display: block;
        }

        .suggestion-card {
            padding: 0;
            cursor: pointer;
            border-bottom: 1px solid #f0f0f0;
            transition: transform 0.25s ease, background-color 0.25s ease, box-shadow 0.25s ease;
            display: flex;
            align-items: stretch;
            overflow: hidden;
            background: white;
        }

        .suggestion-card:first-child {
            border-top-left-radius: 8px;
            border-top-right-radius: 8px;
        }

        .suggestion-card:last-child {
            border-bottom: none;
            border-bottom-left-radius: 8px;
            border-bottom-right-radius: 8px;
        }

        .suggestion-card:hover {
            background: #f8f9fa;
            transform: translateX(4px) scale(1.01);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .suggestion-card.selected {
            background: #f0f4ff;
            border-left: 3px solid #667eea;
        }

        .suggestion-image {
            width: 80px;
            min-width: 80px;
            height: 80px;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-color: #f9fafb;
            position: relative;
            filter: contrast(1.05) saturate(1.05);
            transition: filter 0.25s ease;
        }

        .suggestion-image::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 30%;
            background: linear-gradient(to top, rgba(0, 0, 0, 0.45), transparent);
        }

        .suggestion-content {
            flex: 1;
            padding: 12px 16px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .suggestion-text {
            font-size: 15px;
            color: #1f2937;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .suggestion-category {
            font-size: 12px;
            color: #6b7280;
        }

        .navigation-bar {
            display: flex;
            gap: 12px;
            margin: 16px 0;
        }

        .nav-btn {
            padding: 8px 14px;
            border-radius: 8px;
            border: 1px solid #d0d7ff;
            background: #f5f7ff;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.2s ease;
        }

        .nav-btn:hover {
            background: #e9ecff;
        }

        .category-section {
            margin-top: 16px;
            display: none;
            animation: fadeInUp 0.3s ease-out;
        }

        .category-section.active {
            display: block;
        }

        .category-section h3 {
            color: #333;
            margin-bottom: 8px;
            font-size: 18px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .category-section h3::before {
            content: 'üéØ';
            font-size: 20px;
        }

        .category-hint {
            background: #f0f9ff;
            border: 1px solid #bae6fd;
            border-radius: 8px;
            padding: 10px 14px;
            margin-bottom: 12px;
            font-size: 13px;
            color: #0369a1;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .hint-icon {
            font-size: 16px;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .category-grid,
        .variants-grid {
            display: grid;
            gap: 20px;
            grid-template-columns: repeat(4, minmax(0, 1fr));
            align-items: stretch;
        }

        /* Tablet: 2 per row */
        @media (max-width: 1024px) {
            .category-grid,
            .variants-grid {
                grid-template-columns: repeat(2, minmax(0, 1fr));
            }
        }

        /* Mobile: 2 per row */
        @media (max-width: 640px) {
            .category-grid,
            .variants-grid {
                grid-template-columns: repeat(2, minmax(0, 1fr));
                gap: 14px;
            }
        }

        .variants-section {
            margin-top: 16px;
            display: none;
            animation: fadeInUp 0.4s ease-out;
        }

        .variants-section.active {
            display: block;
        }

        .variants-section h3 {
            color: #333;
            margin-bottom: 8px;
            font-size: 18px;
            font-weight: 600;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .variants-section h3::before {
            content: 'üì¶';
            font-size: 20px;
        }

        .variants-hint {
            background: #f0fdf4;
            border: 1px solid #86efac;
            border-radius: 8px;
            padding: 10px 14px;
            margin-bottom: 12px;
            font-size: 13px;
            color: #166534;
            display: flex;
            align-items: center;
            gap: 8px;
            text-align: center;
            justify-content: center;
        }


        .variant-card {
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.25s ease, border-color 0.25s ease, box-shadow 0.25s ease, filter 0.25s ease;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            position: relative;
            height: 160px;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            filter: contrast(1.05) saturate(1.05);
        }

        .variant-card:hover {
            border-color: #667eea;
            box-shadow: 0 8px 24px rgba(102, 126, 234, 0.3);
            transform: scale(1.03);
        }

        .variant-card.selected {
            border: 2px solid #667eea;
            box-shadow: 0 12px 30px rgba(102, 126, 234, 0.35);
        }

        .variant-card::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 60%;
            background: linear-gradient(to top, rgba(0, 0, 0, 0.45) 0%, rgba(0, 0, 0, 0.3) 50%, transparent 100%);
            pointer-events: none;
        }

        .variant-card-image {
            display: none;
        }

        .variant-card-image-placeholder {
            display: none;
        }

        .variant-card-label {
            padding: 12px 10px 10px;
            text-align: center;
            position: relative;
            z-index: 1;
        }

        .variant-card-label-title {
            font-size: 15px;
            font-weight: 600;
            color: white;
            margin-bottom: 4px;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
        }

        .variant-card-label-subtitle {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.4;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
        }

        .variant-card-tooltip {
            position: absolute;
            top: 8px;
            right: 8px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 6px 10px;
            font-size: 11px;
            text-align: center;
            border-radius: 4px;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
            z-index: 2;
        }

        .variant-card:hover .variant-card-tooltip {
            opacity: 1;
        }

        .variants-group {
            margin-bottom: 16px;
        }

        .variants-group-title {
            font-size: 16px;
            font-weight: 600;
            color: #4b5563;
            margin-bottom: 12px;
            text-align: left;
        }

        .continue-btn {
            display: block;
            margin: 32px auto 0;
            padding: 14px 32px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
        }

        .continue-btn:hover:not(:disabled) {
            background: #5568d3;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
            transform: translateY(-2px);
        }

        .continue-btn:disabled {
            background: #cbd5e1;
            color: #94a3b8;
            cursor: not-allowed;
            box-shadow: none;
            opacity: 0.6;
        }

        .selection-confirmation {
            margin-top: 16px;
            padding: 12px 16px;
            background: #f0f9ff;
            border: 2px solid #667eea;
            border-radius: 8px;
            display: none;
            align-items: center;
            gap: 10px;
            animation: fadeInUp 0.3s ease-out;
        }

        .selection-confirmation.active {
            display: flex;
        }

        .selection-confirmation-icon {
            font-size: 20px;
            color: #667eea;
        }

        .selection-confirmation-text {
            flex: 1;
            font-size: 14px;
            color: #1e40af;
            font-weight: 500;
        }

        .selection-confirmation-label {
            font-weight: 600;
            color: #667eea;
        }

        /* What AI Often Misses Section */
        .ai-misses-section {
            margin-top: 16px;
            margin-bottom: 16px;
            padding: 20px;
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border-radius: 16px;
            border: 2px solid #f59e0b;
            box-shadow: 0 4px 16px rgba(245, 158, 11, 0.2);
        }

        .ai-misses-section h3 {
            color: #92400e;
            margin-bottom: 8px;
            font-size: 22px;
            font-weight: 700;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .ai-misses-section .section-subtitle {
            text-align: center;
            color: #78350f;
            font-size: 14px;
            margin-bottom: 24px;
            font-style: italic;
        }

        .ai-misses-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 12px;
            margin-top: 12px;
        }

        .ai-miss-card {
            background: white;
            border: 2px solid #fbbf24;
            border-left: 4px solid #f59e0b;
            border-radius: 12px;
            padding: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            display: flex;
            gap: 12px;
            align-items: flex-start;
        }

        .ai-miss-card:hover {
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
            transform: translateY(-2px);
            border-color: #f59e0b;
        }

        .ai-miss-icon {
            font-size: 24px;
            min-width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #fef3c7;
            border-radius: 8px;
            flex-shrink: 0;
        }

        .ai-miss-content {
            flex: 1;
        }

        .ai-miss-title {
            font-size: 15px;
            font-weight: 600;
            color: #78350f;
            margin-bottom: 6px;
            line-height: 1.3;
        }

        .ai-miss-explanation {
            font-size: 13px;
            color: #92400e;
            line-height: 1.5;
        }

        @media (max-width: 768px) {
            .ai-misses-section {
                padding: 20px;
                margin-top: 30px;
                margin-bottom: 30px;
            }

            .ai-misses-section h3 {
                font-size: 18px;
            }

            .ai-misses-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .ai-miss-card {
                padding: 12px;
            }

            .ai-miss-icon {
                font-size: 20px;
                min-width: 28px;
                height: 28px;
            }

            .ai-miss-title {
                font-size: 14px;
            }

            .ai-miss-explanation {
                font-size: 12px;
            }
        }

        @media (max-width: 768px) {
            .category-card {
                height: 180px;
            }
            
            .category-card-content {
                padding: 12px 10px 10px;
            }
            
            .category-card-title {
                font-size: 14px;
            }
            
            .category-card-desc {
                font-size: 12px;
            }
            
            .variant-card {
                height: 160px;
            }
            
            .variant-card-label {
                padding: 12px 10px 10px;
            }
            
            .variant-card-label-title {
                font-size: 13px;
            }
            
            .variant-card-label-subtitle {
                font-size: 11px;
            }
            
            .autocomplete-dropdown {
                max-height: 300px;
            }

            body {
                padding: 16px;
            }

            .container {
                padding: 24px;
            }
        }

        /* Remove any fixed widths that shrink cards */
        .category-card,
        .variant-card {
            width: auto !important;
            max-width: none !important;
            min-width: 0 !important;
            flex: none !important;
            border-radius: 14px;
        }

        /* Ensure images fill cards */
        .category-card,
        .variant-card {
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        .category-card {
            background: #f9fafb;
            border: 2px solid #e0e0e0;
            cursor: pointer;
            transition: transform 0.25s ease, border-color 0.25s ease, box-shadow 0.25s ease, filter 0.25s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            position: relative;
            height: 220px;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            overflow: hidden;
            filter: contrast(1.05) saturate(1.05);
        }

        .category-card:hover {
            border-color: #667eea;
            box-shadow: 0 8px 24px rgba(102, 126, 234, 0.3);
            transform: scale(1.03);
        }

        .category-card.selected {
            border: 2px solid #667eea;
            box-shadow: 0 12px 30px rgba(102, 126, 234, 0.35);
        }

        .category-card::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 60%;
            background: linear-gradient(to top, rgba(0, 0, 0, 0.45) 0%, rgba(0, 0, 0, 0.3) 50%, transparent 100%);
            pointer-events: none;
        }

        .category-card-image {
            display: none;
        }

        .category-card-image-placeholder {
            display: none;
        }

        .category-card-icon {
            display: none;
        }

        .category-card-content {
            padding: 12px 10px 10px;
            text-align: center;
            position: relative;
            z-index: 1;
        }

        .category-card-title {
            font-size: 16px;
            font-weight: 600;
            color: white;
            margin-bottom: 6px;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
        }

        .category-card-desc {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.4;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
        }

        .analyze-btn {
            padding: 15px 30px;
            font-size: 16px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .analyze-btn:hover {
            background: #5568d3;
        }

        .analyze-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .content-section {
            margin-top: 12px;
            max-height: 0;
            opacity: 0;
            overflow: hidden;
            transition: max-height 0.4s ease-out, opacity 0.3s ease-out, margin-top 0.3s ease-out;
        }

        .content-section.active {
            max-height: 5000px;
            opacity: 1;
            margin-top: 12px;
        }

        .decision-card {
            background: white;
            border-radius: 12px;
            padding: 16px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            border-left: 4px solid;
            margin-bottom: 12px;
            transition: box-shadow 0.2s ease, transform 0.2s ease;
        }

        .decision-card:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
            transform: translateY(-2px);
        }

        .decision-card.info {
            background: #f0f9ff;
            border-left-color: #3b82f6;
        }

        .decision-card.safe {
            background: #f0fdf4;
            border-left-color: #22c55e;
        }

        .decision-card.highlighted-recommendation {
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            border-left-width: 6px;
            box-shadow: 0 4px 12px rgba(34, 197, 94, 0.2);
            animation: pulseHighlight 2s ease-in-out infinite;
        }

        @keyframes pulseHighlight {
            0%, 100% {
                box-shadow: 0 4px 12px rgba(34, 197, 94, 0.2);
            }
            50% {
                box-shadow: 0 6px 16px rgba(34, 197, 94, 0.3);
            }
        }

        /* Beginner summary animation */
        #beginnerSummary {
            animation-delay: 0.3s;
        }

        #beginnerSummary.active {
            animation: fadeInUp 0.5s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .decision-card.caution {
            background: #fffbeb;
            border-left-color: #f59e0b;
        }

        .decision-card.risk {
            background: #fef2f2;
            border-left-color: #ef4444;
        }

        .decision-card.ai-insight {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border-left: 6px solid #f59e0b;
            border-top: 3px solid #f59e0b;
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.2);
            position: relative;
        }

        .decision-card.ai-insight::before {
            content: "‚ö†Ô∏è";
            position: absolute;
            top: -15px;
            right: 20px;
            font-size: 32px;
            background: white;
            padding: 5px;
            border-radius: 50%;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .ai-blindspot {
            background: white;
            border-left: 4px solid #f59e0b;
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 6px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            transition: box-shadow 0.2s ease, transform 0.2s ease;
        }

        .ai-blindspot:hover {
            box-shadow: 0 4px 8px rgba(245, 158, 11, 0.15);
            transform: translateX(4px);
        }

        .ai-blindspot:last-child {
            margin-bottom: 0;
        }

        .ai-blindspot-title {
            font-weight: 600;
            color: #92400e;
            margin-bottom: 8px;
            font-size: 15px;
        }

        .ai-blindspot-reason {
            color: #78350f;
            font-size: 13px;
            margin-bottom: 8px;
            font-style: italic;
        }

        .ai-blindspot-consequence {
            color: #451a03;
            font-size: 14px;
            line-height: 1.6;
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 10px;
        }

        .card-icon {
            font-size: 24px;
            line-height: 1;
        }

        .card-title {
            color: #1f2937;
            font-size: 18px;
            font-weight: 600;
            margin: 0;
        }

        .card-content {
            color: #4b5563;
            font-size: 14px;
            line-height: 1.6;
        }

        .technical-toggle {
            background: transparent;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            padding: 6px 12px;
            font-size: 12px;
            color: #667eea;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.2s ease;
            white-space: nowrap;
        }

        .technical-toggle:hover {
            background: #f0f4ff;
            border-color: #667eea;
        }

        .technical-toggle.expanded .toggle-icon {
            transform: rotate(180deg);
        }

        .technical-toggle .toggle-text {
            font-weight: 500;
        }

        .technical-toggle .toggle-icon {
            font-size: 10px;
            transition: transform 0.2s ease;
        }

        .technical-details {
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid #e0e0e0;
        }

        .card-bullets {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .card-bullets li {
            margin-bottom: 8px;
            padding-left: 20px;
            position: relative;
            line-height: 1.5;
            transition: all 0.2s ease;
        }

        .card-bullets li::before {
            content: "‚Ä¢";
            position: absolute;
            left: 0;
            font-weight: bold;
            font-size: 18px;
        }

        /* Hover effect for comparison items */
        #comparisonText .card-bullets li {
            padding: 8px 12px;
            margin-left: -12px;
            border-radius: 4px;
            cursor: default;
        }

        #comparisonText .card-bullets li:hover {
            background: rgba(59, 130, 246, 0.08);
            transform: translateX(4px);
        }

        .comparison-cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 16px;
            margin-top: 12px;
        }

        .comparison-card {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            overflow: hidden;
            transition: transform 0.25s ease, box-shadow 0.25s ease, border-color 0.25s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            cursor: pointer;
        }

        .comparison-card:hover {
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);
            transform: translateY(-2px) scale(1.03);
        }

        .comparison-card.selected {
            border: 2px solid #667eea;
            box-shadow: 0 12px 30px rgba(102, 126, 234, 0.35);
        }

        .comparison-card-image {
            width: 100%;
            height: 160px;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-color: #f9fafb;
            position: relative;
            filter: contrast(1.05) saturate(1.05);
            transition: filter 0.25s ease;
        }

        .comparison-card-image::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 40%;
            background: linear-gradient(to top, rgba(0, 0, 0, 0.45), transparent);
            pointer-events: none;
            z-index: 1;
        }

        .comparison-card-content {
            padding: 16px;
        }

        .comparison-card-title {
            font-size: 16px;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 12px;
        }

        .comparison-card-detail {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            font-size: 13px;
        }

        .comparison-card-detail-label {
            font-weight: 600;
            color: #6b7280;
            min-width: 110px;
            margin-right: 8px;
            font-size: 12px;
        }

        .comparison-card-detail-value {
            color: #1f2937;
            flex: 1;
        }

        .durability-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .durability-low {
            background: #fef2f2;
            color: #dc2626;
        }

        .durability-medium {
            background: #fffbeb;
            color: #d97706;
        }

        .durability-high {
            background: #f0fdf4;
            color: #16a34a;
        }

        .beginner-friendly-yes {
            color: #16a34a;
            font-weight: 600;
        }

        .beginner-friendly-no {
            color: #dc2626;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .comparison-cards-grid {
                grid-template-columns: 1fr;
                gap: 16px;
            }
        }

        .decision-card.info .card-bullets li::before {
            color: #3b82f6;
        }

        .decision-card.safe .card-bullets li::before {
            color: #22c55e;
        }

        .decision-card.caution .card-bullets li::before {
            color: #f59e0b;
        }

        .decision-card.risk .card-bullets li::before {
            color: #ef4444;
        }

        .description {
            line-height: 1.6;
            color: #4b5563;
            margin: 0;
        }

        .view-toggle-section {
            margin-top: 20px;
            margin-bottom: 20px;
            display: none;
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .view-toggle-section.active {
            display: block;
        }

        .view-toggle {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .view-toggle-btn {
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 500;
            border: 2px solid #e5e7eb;
            background: white;
            color: #6b7280;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .view-toggle-btn:hover {
            border-color: #667eea;
            color: #667eea;
        }

        .view-toggle-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }


        .steps {
            list-style: none;
            counter-reset: step-counter;
        }

        .steps li {
            counter-increment: step-counter;
            margin-bottom: 15px;
            padding-left: 40px;
            position: relative;
            line-height: 1.6;
            color: #555;
        }

        .steps li::before {
            content: counter(step-counter);
            position: absolute;
            left: 0;
            top: 0;
            background: #667eea;
            color: white;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
        }


        .disclaimer {
            text-align: center;
            margin-top: 12px;
            padding: 12px;
            font-size: 13px;
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.6;
        }

        .disclaimer-subtitle {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.7);
            margin-top: 8px;
            font-style: italic;
        }

        .site-footer {
            margin-top: 40px;
            padding-top: 24px;
            border-top: 1px solid #e5e7eb;
            background: white;
        }

        .footer-content {
            text-align: center;
            padding: 20px 0;
        }

        .footer-title {
            font-size: 16px;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 4px;
        }

        .footer-subtitle {
            font-size: 12px;
            color: #6b7280;
            margin-bottom: 12px;
            font-style: italic;
        }

        .footer-note {
            font-size: 13px;
            color: #4b5563;
            margin-bottom: 8px;
            line-height: 1.5;
        }

        .footer-audience {
            font-size: 12px;
            color: #6b7280;
            line-height: 1.5;
        }

        @media (max-width: 768px) {
            .site-footer {
                margin-top: 24px;
                padding-top: 20px;
            }

            .footer-content {
                padding: 16px 0;
            }

            .footer-title {
                font-size: 15px;
            }

            .footer-note {
                font-size: 12px;
            }

            .footer-audience {
                font-size: 11px;
            }
        }

        .clarification-section {
            margin-top: 12px;
            padding: 0;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #dee2e6;
            overflow: hidden;
            display: none;
        }

        .clarification-section.active {
            display: block;
        }

        .clarification-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px;
            cursor: pointer;
            user-select: none;
            background: #f8f9fa;
            transition: background 0.3s;
        }

        .clarification-header:hover {
            background: #e9ecef;
        }

        .clarification-header h3 {
            color: #495057;
            margin: 0;
            font-size: 15px;
            font-weight: 600;
        }

        .clarification-toggle {
            color: #6c757d;
            font-size: 14px;
            transition: transform 0.3s;
        }

        .clarification-toggle.expanded {
            transform: rotate(180deg);
        }

        .clarification-note {
            font-size: 11px;
            color: #6c757d;
            font-style: italic;
            margin-top: 5px;
        }

        .clarification-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
            padding: 0 20px;
        }

        .clarification-content.expanded {
            max-height: 2000px;
            padding: 16px;
        }

        /* Grid layout for desktop - category and variants side by side */
        .selection-flow-container {
            display: block;
        }

        @media (min-width: 1024px) {
            .selection-flow-container {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 20px;
                align-items: start;
            }

            .category-section,
            .variants-section {
                margin-top: 0;
            }

            .category-section.active + .variants-section.active {
                margin-top: 0;
            }
        }

        .question-group {
            margin-bottom: 12px;
        }

        .question-group label {
            display: block;
            color: #333;
            font-weight: 500;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .question-group select,
        .question-group input[type="text"] {
            width: 100%;
            padding: 10px;
            font-size: 14px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            background: white;
            transition: border-color 0.3s;
        }

        .question-group select:focus,
        .question-group input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
        }

        .clarification-actions {
            margin-top: 12px;
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 12px 24px;
            font-size: 14px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5568d3;
        }

        .btn-secondary {
            background: #e0e0e0;
            color: #333;
        }

        .btn-secondary:hover {
            background: #d0d0d0;
        }

        .export-section {
            margin-top: 12px;
            padding: 16px;
            background: #f8f9fa;
            border-radius: 8px;
            border-top: 3px solid #667eea;
            display: none;
        }

        .export-section.active {
            display: block;
        }

        .export-section h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .export-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn-export {
            padding: 10px 20px;
            font-size: 14px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            background: #667eea;
            color: white;
        }

        .btn-export:hover {
            background: #5568d3;
        }

        .btn-export-secondary {
            background: #6c757d;
        }

        .btn-export-secondary:hover {
            background: #5a6268;
        }

        .copy-feedback {
            display: inline-block;
            margin-left: 10px;
            color: #28a745;
            font-size: 12px;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .copy-feedback.show {
            opacity: 1;
        }

        .pro-badge {
            display: inline-block;
            padding: 4px 10px;
            background: #e9ecef;
            color: #6c757d;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-left: 10px;
            opacity: 0.7;
            cursor: not-allowed;
        }

        .pro-note {
            font-size: 12px;
            color: #6c757d;
            font-style: italic;
            margin-top: 10px;
            padding: 8px;
            background: #f8f9fa;
            border-left: 3px solid #dee2e6;
            border-radius: 4px;
        }

        .pricing-section {
            margin-top: 12px;
            padding: 16px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 8px;
            border: 2px dashed #dee2e6;
            text-align: center;
        }

        .pricing-section h3 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .pricing-plans {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .pricing-plan {
            background: white;
            padding: 20px;
            border-radius: 8px;
            border: 2px solid #dee2e6;
            min-width: 200px;
            opacity: 0.8;
        }

        .pricing-plan.pro {
            border-color: #667eea;
            background: linear-gradient(135deg, #ffffff 0%, #f0f4ff 100%);
        }

        .pricing-plan h4 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .pricing-plan.free h4 {
            color: #6c757d;
        }

        .price {
            font-size: 24px;
            font-weight: bold;
            color: #333;
            margin: 10px 0;
        }

        .price-placeholder {
            font-size: 12px;
            color: #6c757d;
            font-style: italic;
        }

        .pricing-features {
            list-style: none;
            padding: 0;
            margin: 15px 0;
            text-align: left;
        }

        .pricing-features li {
            padding: 5px 0;
            font-size: 13px;
            color: #495057;
        }

        .pricing-features li:before {
            content: "‚úì ";
            color: #28a745;
            font-weight: bold;
            margin-right: 5px;
        }

        .pricing-features li.disabled:before {
            content: "‚óã ";
            color: #dee2e6;
        }

        .pricing-features li.disabled {
            color: #adb5bd;
        }

        .pricing-cta {
            margin-top: 15px;
            padding: 10px 20px;
            background: #6c757d;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: not-allowed;
            font-size: 14px;
            opacity: 0.6;
        }

        .roadmap-section {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #dee2e6;
        }

        .roadmap-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            user-select: none;
        }

        .roadmap-header h4 {
            color: #495057;
            font-size: 14px;
            font-weight: 600;
            margin: 0;
        }

        .roadmap-toggle {
            color: #6c757d;
            font-size: 18px;
            transition: transform 0.3s;
        }

        .roadmap-toggle.expanded {
            transform: rotate(180deg);
        }

        .roadmap-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
            margin-top: 15px;
        }

        .roadmap-content.expanded {
            max-height: 500px;
        }

        .roadmap-item {
            margin-bottom: 15px;
            padding-left: 20px;
            position: relative;
        }

        .roadmap-item:last-child {
            margin-bottom: 0;
        }

        .roadmap-item::before {
            content: "‚Üí";
            position: absolute;
            left: 0;
            color: #667eea;
            font-weight: bold;
        }

        .roadmap-item h5 {
            color: #495057;
            font-size: 13px;
            font-weight: 600;
            margin: 0 0 5px 0;
        }

        .roadmap-item p {
            color: #6c757d;
            font-size: 12px;
            margin: 0;
            line-height: 1.5;
        }


        @media print {
            body {
                background: white;
                padding: 0;
            }
            .container {
                box-shadow: none;
                max-width: 100%;
            }
            .input-section,
            .clarification-section,
            .export-section,
            .disclaimer,
            .pricing-section {
                display: none !important;
            }
            .content-section {
                page-break-inside: avoid;
                margin-top: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Product Intelligence MVP <span class="pro-badge" title="Pro features coming soon">Pro</span></h1>
        
        <div class="input-section">
            <div class="input-wrapper">
                <div class="search-icon-wrapper">
                    <span class="search-icon">üîç</span>
                </div>
                <input 
                    type="text" 
                    id="productInput" 
                    placeholder="Search for a product (e.g. Cricket Bat, Forklift, Safety Gloves)"
                    autocomplete="off"
                />
                <button class="analyze-btn" id="analyzeBtn" style="display: none;">Analyse Product</button>
            </div>
            <div class="autocomplete-dropdown" id="autocompleteDropdown"></div>
            <div class="search-note">Currently supports selected product categories only</div>
        </div>

        <div class="selection-flow-container">
            <div id="categorySection" class="category-section">
                <div class="navigation-bar">
                    <button class="nav-btn" onclick="resetToProduct()">‚Üê Change Product</button>
                    <button class="nav-btn" onclick="resetToType()">‚Üê Change Type</button>
                </div>
                <h3>Choose the type</h3>
                <div class="category-grid" id="categoryGrid"></div>
                <div class="selection-confirmation" id="categorySelectionConfirmation">
                    <span class="selection-confirmation-icon">‚úì</span>
                    <span class="selection-confirmation-text">
                        <span class="selection-confirmation-label">Selected:</span> <span id="selectedCategoryName"></span>
                    </span>
                </div>
            </div>

            <div id="variantsSection" class="variants-section">
                <h3>Common Variants & Options</h3>
                <div id="variantsContainer"></div>
                <div class="selection-confirmation" id="variantSelectionConfirmation">
                    <span class="selection-confirmation-icon">‚úì</span>
                    <span class="selection-confirmation-text">
                        <span class="selection-confirmation-label">Selected:</span> <span id="selectedVariantName"></span>
                    </span>
                </div>
                <button class="continue-btn" id="continueBtn" style="display: none;" disabled>Continue to Analysis</button>
            </div>
        </div>

        <div id="clarificationSection" class="clarification-section">
            <div class="clarification-header" id="clarificationHeader">
                <div>
                    <h3>Refine the analysis (optional)</h3>
                    <div class="clarification-note">Optional ‚Äî improves accuracy, not required</div>
                </div>
                <span class="clarification-toggle" id="clarificationToggle">‚ñº</span>
            </div>
            <div class="clarification-content" id="clarificationContent">
                <div id="questionsContainer"></div>
            </div>
        </div>

        <div id="viewToggleSection" class="view-toggle-section">
            <div class="view-toggle">
                <button class="view-toggle-btn active" id="beginnerViewBtn">Beginner View</button>
                <button class="view-toggle-btn" id="expertViewBtn">Expert View</button>
            </div>
        </div>

        <div id="productOverview" class="content-section">
            <div class="decision-card info">
                <div class="card-header">
                    <span class="card-icon">üìã</span>
                    <h2 class="card-title">Product Overview</h2>
                </div>
                <div class="card-content">
                    <p class="description" id="overviewText"></p>
                </div>
            </div>
        </div>

        <div id="beginnerRecommendation" class="content-section" style="display: none;">
            <div class="decision-card safe highlighted-recommendation">
                <div class="card-header">
                    <span class="card-icon">‚ú®</span>
                    <h2 class="card-title">What Most Buyers Choose</h2>
                </div>
                <div class="card-content">
                    <p class="description" id="beginnerRecommendationText"></p>
                </div>
            </div>
        </div>

        <div id="keyAttributes" class="content-section">
            <div class="decision-card info">
                <div class="card-header">
                    <span class="card-icon">‚öôÔ∏è</span>
                    <h2 class="card-title">Common options</h2>
                    <button class="technical-toggle" id="technicalToggle" style="display: none;">
                        <span class="toggle-text">Show technical details (optional)</span>
                        <span class="toggle-icon">‚ñº</span>
                    </button>
                </div>
                <div class="card-content">
                    <ul class="card-bullets" id="attributesList"></ul>
                    <div class="technical-details" id="technicalDetails" style="display: none;">
                        <ul class="card-bullets" id="technicalList"></ul>
                    </div>
                </div>
            </div>
        </div>

        <div id="variantsOptions" class="content-section">
            <div class="decision-card info">
                <div class="card-header">
                    <span class="card-icon">üì¶</span>
                    <h2 class="card-title">Choose the type</h2>
                </div>
                <div class="card-content">
                    <ul class="card-bullets" id="variantsList"></ul>
                </div>
            </div>
        </div>

        <div id="realWorldUsage" class="content-section">
            <div class="decision-card safe">
                <div class="card-header">
                    <span class="card-icon">‚úÖ</span>
                    <h2 class="card-title">How it's used</h2>
                </div>
                <div class="card-content">
                    <ul class="card-bullets" id="usageScenariosList"></ul>
                </div>
            </div>
        </div>

        <div id="aiMissesSection" class="ai-misses-section" style="display: none;">
            <h3>
                <span>‚ö†Ô∏è</span>
                Important Considerations
            </h3>
            <div class="section-subtitle">Key factors buyers often overlook</div>
            <div class="ai-misses-grid" id="aiMissesGrid"></div>
        </div>

        <div id="aiInsight" class="content-section">
            <div class="decision-card ai-insight">
                <div class="card-header">
                    <span class="card-icon">‚ö†Ô∏è</span>
                    <h2 class="card-title">Important Considerations</h2>
                </div>
                <div class="card-content" id="aiInsightBlindspots">
                    <!-- Blind spots will be inserted here -->
                </div>
            </div>
            <div class="decision-card risk">
                <div class="card-header">
                    <span class="card-icon">üö´</span>
                    <h2 class="card-title">Who This Product Is NOT Suitable For</h2>
                </div>
                <div class="card-content">
                    <ul class="card-bullets" id="notSuitableList"></ul>
                </div>
            </div>
        </div>

        <div id="comparisonInsight" class="content-section">
            <div class="decision-card info">
                <div class="card-header">
                    <span class="card-icon">‚öñÔ∏è</span>
                    <h2 class="card-title">Key Variants Compared</h2>
                </div>
                <div class="card-content">
                    <div class="comparison-cards-grid" id="comparisonCards"></div>
                    <div id="comparisonText" style="display: none;"></div>
                </div>
            </div>
        </div>

        <div id="beginnerSummary" class="content-section">
            <div class="decision-card safe">
                <div class="card-header">
                    <span class="card-icon">üí°</span>
                    <h2 class="card-title">7. Beginner Summary</h2>
                </div>
                <div class="card-content">
                    <ul class="card-bullets" id="beginnerSummaryText"></ul>
                </div>
            </div>
        </div>

        <div id="exportSection" class="export-section">
            <h3>Save / Export</h3>
            <div class="export-buttons">
                <button class="btn btn-export" id="copyBtn">Copy to Clipboard</button>
                <button class="btn btn-export btn-export-secondary" id="exportTextBtn">Export as Text</button>
                <button class="btn btn-export btn-export-secondary" id="exportPdfBtn">Print / PDF</button>
            </div>
            <span class="copy-feedback" id="copyFeedback">Copied to clipboard!</span>
        </div>
    </div>

    <div class="pricing-section">
        <h3>Upgrade to Pro</h3>
        <p class="price-placeholder">Unlock advanced features and deeper insights</p>
        <div class="pricing-plans">
            <div class="pricing-plan free">
                <h4>Free</h4>
                <div class="price">$0</div>
                <ul class="pricing-features">
                    <li>Basic product intelligence</li>
                    <li>Standard comparisons</li>
                    <li>Export to text/PDF</li>
                    <li class="disabled">Advanced AI insights</li>
                    <li class="disabled">Competitor analysis</li>
                    <li class="disabled">Custom reports</li>
                </ul>
                <button class="pricing-cta" disabled>Current Plan</button>
            </div>
            <div class="pricing-plan pro">
                <h4>Pro</h4>
                <div class="price">Coming Soon</div>
                <ul class="pricing-features">
                    <li>Everything in Free</li>
                    <li>Advanced comparisons</li>
                    <li>Competitor benchmarking</li>
                    <li>Custom report templates</li>
                    <li>API access</li>
                    <li>Priority support</li>
                </ul>
                <button class="pricing-cta" disabled>Coming Soon</button>
            </div>
        </div>
    </div>

    <div class="roadmap-section">
        <div class="roadmap-header" id="roadmapHeader">
            <h4>Product Roadmap</h4>
            <span class="roadmap-toggle" id="roadmapToggle">‚ñº</span>
        </div>
        <div class="roadmap-content" id="roadmapContent">
            <div class="roadmap-item">
                <h5>Current</h5>
                <p>Early-stage MVP with illustrative data</p>
            </div>
            <div class="roadmap-item">
                <h5>Next</h5>
                <p>Industry-specific intelligence and deeper insights</p>
            </div>
            <div class="roadmap-item">
                <h5>Later</h5>
                <p>Real data integration and enterprise features</p>
            </div>
        </div>
    </div>

    <div class="disclaimer">
        This is an early-stage Product Intelligence MVP using illustrative data. The platform demonstrates structured decision-support logic, not generic AI content generation.
    </div>

    <footer class="site-footer">
        <div class="footer-content">
            <div class="footer-title">Product Intelligence MVP</div>
            <div class="footer-subtitle">Early-stage</div>
            <div class="footer-note">Illustrative data ‚Äî not commercial advice</div>
            <div class="footer-audience">Built for businesses, warehouses, and operational teams</div>
        </div>
    </footer>

    <script>
        // Store context answers
        let contextAnswers = {};
        
        // Store current product data for export
        let currentProductName = '';
        let currentContent = null;
        let currentView = 'beginner'; // 'beginner' or 'expert'
        let selectedProduct = null;
        let selectedType = null; // Selected category type
        let selectedVariant = null; // Selected variant

        // Navigation functions
        function resetToProduct() {
            selectedProduct = null;
            selectedType = null;
            selectedVariant = null;
            document.getElementById('productInput').value = '';
            document.getElementById('categorySection').classList.remove('active');
            document.getElementById('variantsSection').classList.remove('active');
            document.getElementById('autocompleteDropdown').classList.remove('active');
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
        }

        function resetToType() {
            selectedVariant = null;
            if (selectedProduct) {
                document.getElementById('variantsSection').classList.remove('active');
                document.getElementById('categorySection').classList.add('active');
                const continueBtn = document.getElementById('continueBtn');
                if (continueBtn) {
                    continueBtn.style.display = 'none';
                    continueBtn.disabled = true;
                }
            }
        }


        // Single helper function to get image for product/category/variant
        // Returns image URL or null (for fallback gradient)
        function getImageFor(productId, categoryId = null, variantId = null) {
            const product = productDatabase[productId];
            if (!product) return null;
            
            // If variant requested, check variant image first
            if (variantId && categoryId) {
                const category = product.categories.find(c => c.name === categoryId);
                if (category && category.variants) {
                    // Search through all variant groups
                    for (const variantGroup of Object.values(category.variants)) {
                        const variant = variantGroup.find(v => v.label === variantId);
                        if (variant && variant.image) {
                            return variant.image;
                        }
                    }
                }
            }
            
            // If category requested, check category hero image
            if (categoryId) {
                const category = product.categories.find(c => c.name === categoryId);
                if (category && product.images && product.images[categoryId]) {
                    return product.images[categoryId].hero;
                }
                // Fallback to old imageUrl field if images.hero doesn't exist
                if (category && category.imageUrl) {
                    return category.imageUrl;
                }
            }
            
            // Default: return null for fallback gradient
            return null;
        }

        // Supported product categories for MVP
        const SUPPORTED_CATEGORIES = [
            'Sports Equipment',
            'Warehouse & Logistics Equipment',
            'Safety & Compliance Equipment',
            'Consumer Electronics'
        ];

        // Mock product database
        const productDatabase = {
            'cricket bat': {
                name: 'Cricket Bat',
                supportedCategory: 'Sports Equipment',
                images: {
                    'Leather Ball Bat': { hero: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Cricket_bat_and_ball.jpg/800px-Cricket_bat_and_ball.jpg' },
                    'Tennis Ball Bat': { hero: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Cricket_bat_and_ball.jpg/800px-Cricket_bat_and_ball.jpg' },
                    'Plastic Ball Bat': { hero: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Cricket_bat_and_ball.jpg/800px-Cricket_bat_and_ball.jpg' },
                    'Training Bat': { hero: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Cricket_bat_and_ball.jpg/800px-Cricket_bat_and_ball.jpg' }
                },
                categories: [
                    { 
                        name: 'Leather Ball Bat', 
                        icon: 'üèè', 
                        desc: 'Used in professional matches and competitive cricket', 
                        imageUrl: 'images/cricket/leather-bat.jpg',
                        variants: {
                            'Handle Length': [
                                { label: 'Short Handle', subtitle: '28-30 inches', image: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Cricket_bat_and_ball.jpg/800px-Cricket_bat_and_ball.jpg', tooltip: 'Better control, lighter swing' },
                                { label: 'Long Handle', subtitle: '32-34 inches', image: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Cricket_bat_and_ball.jpg/800px-Cricket_bat_and_ball.jpg', tooltip: 'More power, extended reach' }
                            ],
                            'Willow Type': [
                                { label: 'English Willow', subtitle: 'Premium quality', image: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Cricket_bat_and_ball.jpg/800px-Cricket_bat_and_ball.jpg', tooltip: 'Professional grade, superior performance' },
                                { label: 'Kashmir Willow', subtitle: 'Budget friendly', image: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Cricket_bat_and_ball.jpg/800px-Cricket_bat_and_ball.jpg', tooltip: 'Affordable, good for practice' }
                            ],
                            'Weight Range': [
                                { label: 'Light (1.1-1.2 kg)', subtitle: 'Quick swing', image: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Cricket_bat_and_ball.jpg/800px-Cricket_bat_and_ball.jpg', tooltip: 'Easier to handle, faster strokes' },
                                { label: 'Medium (1.2-1.3 kg)', subtitle: 'Balanced', image: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Cricket_bat_and_ball.jpg/800px-Cricket_bat_and_ball.jpg', tooltip: 'Good balance of power and control' },
                                { label: 'Heavy (1.3-1.4 kg)', subtitle: 'Maximum power', image: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Cricket_bat_and_ball.jpg/800px-Cricket_bat_and_ball.jpg', tooltip: 'More power, requires strength' }
                            ]
                        }
                    },
                    { 
                        name: 'Tennis Ball Bat', 
                        icon: 'üèè', 
                        desc: 'Designed for casual play and practice sessions', 
                        imageUrl: 'images/cricket/tennis-bat.jpg',
                        variants: {
                            'Size': [
                                { label: 'Junior', subtitle: 'Ages 5-10', image: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Cricket_bat_and_ball.jpg/800px-Cricket_bat_and_ball.jpg', tooltip: 'Smaller size for kids' },
                                { label: 'Senior', subtitle: 'Standard size', image: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Cricket_bat_and_ball.jpg/800px-Cricket_bat_and_ball.jpg', tooltip: 'Full-size for adults' }
                            ],
                            'Material': [
                                { label: 'Wood', subtitle: 'Traditional', image: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Cricket_bat_and_ball.jpg/800px-Cricket_bat_and_ball.jpg', tooltip: 'Classic feel and durability' },
                                { label: 'Composite', subtitle: 'Modern', image: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Cricket_bat_and_ball.jpg/800px-Cricket_bat_and_ball.jpg', tooltip: 'Lightweight and durable' }
                            ]
                        }
                    },
                    { 
                        name: 'Plastic Ball Bat', 
                        icon: 'üèè', 
                        desc: 'Lightweight option for beginners and children', 
                        variants: {
                            'Size': [
                                { label: 'Small', subtitle: 'Kids 5-8 years', image: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Cricket_bat_and_ball.jpg/800px-Cricket_bat_and_ball.jpg', tooltip: 'Perfect for young beginners' },
                                { label: 'Medium', subtitle: 'Kids 8-12 years', image: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Cricket_bat_and_ball.jpg/800px-Cricket_bat_and_ball.jpg', tooltip: 'Growing players' },
                                { label: 'Large', subtitle: 'Teens & adults', image: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Cricket_bat_and_ball.jpg/800px-Cricket_bat_and_ball.jpg', tooltip: 'Full-size lightweight option' }
                            ]
                        }
                    },
                    { 
                        name: 'Training Bat', 
                        icon: 'üèè', 
                        desc: 'Specialized bat for practice and skill development', 
                        variants: {
                            'Type': [
                                { label: 'Heavy Bat', subtitle: 'Strength training', image: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Cricket_bat_and_ball.jpg/800px-Cricket_bat_and_ball.jpg', tooltip: 'Builds wrist and arm strength' },
                                { label: 'Light Bat', subtitle: 'Speed training', image: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Cricket_bat_and_ball.jpg/800px-Cricket_bat_and_ball.jpg', tooltip: 'Improves swing speed' },
                                { label: 'Weighted Bat', subtitle: 'Conditioning', image: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Cricket_bat_and_ball.jpg/800px-Cricket_bat_and_ball.jpg', tooltip: 'Advanced training tool' }
                            ]
                        }
                    }
                ]
            },
            'cricket ball': {
                name: 'Cricket Ball',
                supportedCategory: 'Sports Equipment',
                images: {
                    'Red Leather Ball': { hero: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Cricket_bat_and_ball.jpg/800px-Cricket_bat_and_ball.jpg' },
                    'White Leather Ball': { hero: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Cricket_bat_and_ball.jpg/800px-Cricket_bat_and_ball.jpg' },
                    'Tennis Ball': { hero: 'https://upload.wikimedia.org/wikipedia/commons/thumb/3/3e/Tennis_ball.jpg/800px-Tennis_ball.jpg' },
                    'Plastic Ball': { hero: 'https://upload.wikimedia.org/wikipedia/commons/thumb/3/3e/Tennis_ball.jpg/800px-Tennis_ball.jpg' }
                },
                categories: [
                    { name: 'Red Leather Ball', icon: '‚öæ', desc: 'Standard ball for test matches and first-class cricket', imageUrl: 'https://images.unsplash.com/photo-1606107557195-0e29a4b5b4aa?w=400&h=300&fit=crop' },
                    { name: 'White Leather Ball', icon: '‚öæ', desc: 'Used in limited-overs and day-night matches', imageUrl: 'https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=400&h=300&fit=crop' },
                    { name: 'Tennis Ball', icon: '‚öæ', desc: 'Soft ball for casual play and practice', imageUrl: 'https://images.unsplash.com/photo-1574629810360-7efbbe195018?w=400&h=300&fit=crop' },
                    { name: 'Plastic Ball', icon: '‚öæ', desc: 'Durable option for street cricket and beginners', imageUrl: 'https://images.unsplash.com/photo-1606107557195-0e29a4b5b4aa?w=400&h=300&fit=crop' }
                ]
            },
            'cricket kit': {
                name: 'Cricket Kit',
                supportedCategory: 'Sports Equipment',
                images: {
                    'Professional Kit': { hero: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Cricket_bat_and_ball.jpg/800px-Cricket_bat_and_ball.jpg' },
                    'Beginner Kit': { hero: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Cricket_bat_and_ball.jpg/800px-Cricket_bat_and_ball.jpg' },
                    'Practice Kit': { hero: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Cricket_bat_and_ball.jpg/800px-Cricket_bat_and_ball.jpg' }
                },
                categories: [
                    { name: 'Professional Kit', icon: 'üéí', desc: 'Complete set for competitive cricket', imageUrl: 'https://images.unsplash.com/photo-1574629810360-7efbbe195018?w=400&h=300&fit=crop' },
                    { name: 'Beginner Kit', icon: 'üéí', desc: 'Essential equipment for new players', imageUrl: 'https://images.unsplash.com/photo-1606107557195-0e29a4b5b4aa?w=400&h=300&fit=crop' },
                    { name: 'Practice Kit', icon: 'üéí', desc: 'Basic kit for training sessions', imageUrl: 'https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=400&h=300&fit=crop' }
                ]
            },
            'safety gloves': {
                name: 'Safety Gloves',
                supportedCategory: 'Safety & Compliance Equipment',
                images: {
                    'Cut-Resistant Gloves': { hero: 'https://images.unsplash.com/photo-1581578731548-c64695cc6952?w=400&h=300&fit=crop' },
                    'Chemical-Resistant Gloves': { hero: 'https://images.unsplash.com/photo-1581578731548-c64695cc6952?w=400&h=300&fit=crop' },
                    'Heat-Resistant Gloves': { hero: 'https://images.unsplash.com/photo-1581578731548-c64695cc6952?w=400&h=300&fit=crop' },
                    'General Purpose Gloves': { hero: 'https://images.unsplash.com/photo-1581578731548-c64695cc6952?w=400&h=300&fit=crop' }
                },
                categories: [
                    { name: 'Cut-Resistant Gloves', icon: 'üß§', desc: 'Protection against sharp objects and blades', imageUrl: 'https://images.unsplash.com/photo-1581578731548-c64695cc6952?w=400&h=300&fit=crop' },
                    { name: 'Chemical-Resistant Gloves', icon: 'üß§', desc: 'For handling hazardous chemicals', imageUrl: 'https://images.unsplash.com/photo-1581578731548-c64695cc6952?w=400&h=300&fit=crop' },
                    { name: 'Heat-Resistant Gloves', icon: 'üß§', desc: 'Protection from high temperatures', imageUrl: 'https://images.unsplash.com/photo-1581578731548-c64695cc6952?w=400&h=300&fit=crop' },
                    { name: 'General Purpose Gloves', icon: 'üß§', desc: 'Multi-purpose protection for various tasks', imageUrl: 'https://images.unsplash.com/photo-1581578731548-c64695cc6952?w=400&h=300&fit=crop' }
                ]
            },
            'forklift': {
                name: 'Forklift',
                supportedCategory: 'Warehouse & Logistics Equipment',
                images: {
                    'Electric Forklift': { hero: 'https://images.unsplash.com/photo-1586528116311-ad8dd3c8310d?w=400&h=300&fit=crop' },
                    'Diesel Forklift': { hero: 'https://images.unsplash.com/photo-1586528116311-ad8dd3c8310d?w=400&h=300&fit=crop' },
                    'LPG Forklift': { hero: 'https://images.unsplash.com/photo-1586528116311-ad8dd3c8310d?w=400&h=300&fit=crop' },
                    'Pallet Jack': { hero: 'https://images.unsplash.com/photo-1586528116311-ad8dd3c8310d?w=400&h=300&fit=crop' }
                },
                categories: [
                    { name: 'Electric Forklift', icon: 'üöú', desc: 'Indoor use with zero emissions', imageUrl: 'https://images.unsplash.com/photo-1586528116311-ad8dd3c8310d?w=400&h=300&fit=crop' },
                    { name: 'Diesel Forklift', icon: 'üöú', desc: 'Heavy-duty outdoor operations', imageUrl: 'https://images.unsplash.com/photo-1586528116311-ad8dd3c8310d?w=400&h=300&fit=crop' },
                    { name: 'LPG Forklift', icon: 'üöú', desc: 'Versatile fuel option for various environments', imageUrl: 'https://images.unsplash.com/photo-1586528116311-ad8dd3c8310d?w=400&h=300&fit=crop' },
                    { name: 'Pallet Jack', icon: 'üöú', desc: 'Manual handling for smaller loads', imageUrl: 'https://images.unsplash.com/photo-1586528116311-ad8dd3c8310d?w=400&h=300&fit=crop' }
                ]
            },
            'helmet': {
                name: 'Helmet',
                supportedCategory: 'Safety & Compliance Equipment',
                images: {
                    'Sports Helmet': { hero: 'https://images.unsplash.com/photo-1551698618-1dfe5d97d256?w=400&h=300&fit=crop' },
                    'Safety Helmet': { hero: 'https://images.unsplash.com/photo-1551698618-1dfe5d97d256?w=400&h=300&fit=crop' },
                    'Motorcycle Helmet': { hero: 'https://images.unsplash.com/photo-1551698618-1dfe5d97d256?w=400&h=300&fit=crop' }
                },
                categories: [
                    { name: 'Sports Helmet', icon: '‚õëÔ∏è', desc: 'Protection for cricket, cycling, and other sports', imageUrl: 'https://images.unsplash.com/photo-1551698618-1dfe5d97d256?w=400&h=300&fit=crop' },
                    { name: 'Safety Helmet', icon: '‚õëÔ∏è', desc: 'Industrial and construction safety', imageUrl: 'https://images.unsplash.com/photo-1551698618-1dfe5d97d256?w=400&h=300&fit=crop' },
                    { name: 'Motorcycle Helmet', icon: '‚õëÔ∏è', desc: 'Road safety for motorcyclists', imageUrl: 'https://images.unsplash.com/photo-1551698618-1dfe5d97d256?w=400&h=300&fit=crop' }
                ]
            },
            'racket': {
                name: 'Racket',
                supportedCategory: 'Sports Equipment',
                images: {
                    'Tennis Racket': { hero: 'https://images.unsplash.com/photo-1622163642999-958314b993f3?w=400&h=300&fit=crop' },
                    'Badminton Racket': { hero: 'https://images.unsplash.com/photo-1622163642999-958314b993f3?w=400&h=300&fit=crop' },
                    'Squash Racket': { hero: 'https://images.unsplash.com/photo-1622163642999-958314b993f3?w=400&h=300&fit=crop' }
                },
                categories: [
                    { name: 'Tennis Racket', icon: 'üéæ', desc: 'For tennis court play', imageUrl: 'https://images.unsplash.com/photo-1622163642999-958314b993f3?w=400&h=300&fit=crop' },
                    { name: 'Badminton Racket', icon: 'üè∏', desc: 'Lightweight for badminton courts', imageUrl: 'https://images.unsplash.com/photo-1622163642999-958314b993f3?w=400&h=300&fit=crop' },
                    { name: 'Squash Racket', icon: 'üéæ', desc: 'Compact design for squash courts', imageUrl: 'https://images.unsplash.com/photo-1622163642999-958314b993f3?w=400&h=300&fit=crop' }
                ]
            },
            'laptop': {
                name: 'Laptop',
                supportedCategory: 'Consumer Electronics',
                images: {
                    'Business Laptop': { hero: 'https://images.unsplash.com/photo-1496181133206-80ce9b88a853?w=400&h=300&fit=crop' },
                    'Gaming Laptop': { hero: 'https://images.unsplash.com/photo-1496181133206-80ce9b88a853?w=400&h=300&fit=crop' },
                    'Student Laptop': { hero: 'https://images.unsplash.com/photo-1496181133206-80ce9b88a853?w=400&h=300&fit=crop' }
                },
                categories: [
                    { name: 'Business Laptop', icon: 'üíª', desc: 'Professional use and productivity', imageUrl: 'https://images.unsplash.com/photo-1496181133206-80ce9b88a853?w=400&h=300&fit=crop' },
                    { name: 'Gaming Laptop', icon: 'üíª', desc: 'High-performance for gaming', imageUrl: 'https://images.unsplash.com/photo-1496181133206-80ce9b88a853?w=400&h=300&fit=crop' },
                    { name: 'Student Laptop', icon: 'üíª', desc: 'Affordable option for education', imageUrl: 'https://images.unsplash.com/photo-1496181133206-80ce9b88a853?w=400&h=300&fit=crop' }
                ]
            },
            'bat': {
                name: 'Cricket Bat',
                supportedCategory: 'Sports Equipment',
                images: {
                    'Leather Ball Bat': { hero: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Cricket_bat_and_ball.jpg/800px-Cricket_bat_and_ball.jpg' },
                    'Tennis Ball Bat': { hero: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Cricket_bat_and_ball.jpg/800px-Cricket_bat_and_ball.jpg' },
                    'Plastic Ball Bat': { hero: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Cricket_bat_and_ball.jpg/800px-Cricket_bat_and_ball.jpg' }
                },
                categories: [
                    { name: 'Leather Ball Bat', icon: 'üèè', desc: 'Used in professional matches and competitive cricket', imageUrl: 'https://images.unsplash.com/photo-1574629810360-7efbbe195018?w=400&h=300&fit=crop' },
                    { name: 'Tennis Ball Bat', icon: 'üèè', desc: 'Designed for casual play and practice sessions', imageUrl: 'https://images.unsplash.com/photo-1606107557195-0e29a4b5b4aa?w=400&h=300&fit=crop' },
                    { name: 'Plastic Ball Bat', icon: 'üèè', desc: 'Lightweight option for beginners and children', imageUrl: 'https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=400&h=300&fit=crop' }
                ]
            },
            'gloves': {
                name: 'Safety Gloves',
                supportedCategory: 'Safety & Compliance Equipment',
                images: {
                    'Cut-Resistant Gloves': { hero: 'https://images.unsplash.com/photo-1581578731548-c64695cc6952?w=400&h=300&fit=crop' },
                    'Chemical-Resistant Gloves': { hero: 'https://images.unsplash.com/photo-1581578731548-c64695cc6952?w=400&h=300&fit=crop' },
                    'Heat-Resistant Gloves': { hero: 'https://images.unsplash.com/photo-1581578731548-c64695cc6952?w=400&h=300&fit=crop' }
                },
                categories: [
                    { name: 'Cut-Resistant Gloves', icon: 'üß§', desc: 'Protection against sharp objects and blades', imageUrl: 'https://images.unsplash.com/photo-1581578731548-c64695cc6952?w=400&h=300&fit=crop' },
                    { name: 'Chemical-Resistant Gloves', icon: 'üß§', desc: 'For handling hazardous chemicals', imageUrl: 'https://images.unsplash.com/photo-1581578731548-c64695cc6952?w=400&h=300&fit=crop' },
                    { name: 'Heat-Resistant Gloves', icon: 'üß§', desc: 'Protection from high temperatures', imageUrl: 'https://images.unsplash.com/photo-1581578731548-c64695cc6952?w=400&h=300&fit=crop' }
                ]
            }
        };

        // Smart search: Get product suggestions with fuzzy matching and relevance scoring
        // Only returns products from supported categories
        function getProductSuggestions(query) {
            if (query.length < 2) return [];
            
            const lowerQuery = query.toLowerCase().trim();
            const suggestions = [];
            const queryWords = lowerQuery.split(/\s+/).filter(w => w.length > 0);
            
            // Score products based on match quality - ONLY from supported categories
            for (const [key, product] of Object.entries(productDatabase)) {
                // Skip products that don't have a supported category
                if (!product.supportedCategory || !SUPPORTED_CATEGORIES.includes(product.supportedCategory)) {
                    continue;
                }
                const productNameLower = product.name.toLowerCase();
                const keyLower = key.toLowerCase();
                let score = 0;
                
                // Exact match gets highest score
                if (keyLower === lowerQuery || productNameLower === lowerQuery) {
                    score = 100;
                }
                // Starts with query
                else if (keyLower.startsWith(lowerQuery) || productNameLower.startsWith(lowerQuery)) {
                    score = 80;
                }
                // Contains query
                else if (keyLower.includes(lowerQuery) || productNameLower.includes(lowerQuery)) {
                    score = 60;
                }
                // Word matches
                else {
                    queryWords.forEach(word => {
                        if (keyLower.includes(word)) score += 30;
                        if (productNameLower.includes(word)) score += 20;
                        // Check category names
                        product.categories.forEach(cat => {
                            if (cat.name.toLowerCase().includes(word)) score += 10;
                        });
                    });
                }
                
                if (score > 0) {
                    // Get product image using new helper
                    const firstCategory = product.categories[0];
                    const productImage = getImageFor(key, firstCategory?.name) || null;
                    
                    suggestions.push({
                        key: key,
                        name: product.name,
                        icon: firstCategory?.icon || 'üì¶',
                        image: productImage,
                        category: firstCategory?.name || 'Product',
                        score: score
                    });
                }
            }
            
            // Sort by relevance score (highest first)
            suggestions.sort((a, b) => b.score - a.score);
            
            return suggestions.slice(0, 5);
        }

        // Show autocomplete suggestions with image-first cards
        function showAutocompleteSuggestions(query) {
            const dropdown = document.getElementById('autocompleteDropdown');
            const suggestions = getProductSuggestions(query);
            
            if (suggestions.length === 0) {
                dropdown.classList.remove('active');
                return;
            }
            
            dropdown.innerHTML = '';
            suggestions.forEach(suggestion => {
                const card = document.createElement('div');
                card.className = 'suggestion-card';
                
                // Use product image if available, otherwise use gradient with icon
                const imageStyle = suggestion.image 
                    ? `background-image: url('${suggestion.image}');`
                    : `background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; font-size: 32px;`;
                
                card.innerHTML = `
                    <div class="suggestion-image" style="${imageStyle}">
                        ${!suggestion.image ? suggestion.icon : ''}
                    </div>
                    <div class="suggestion-content">
                        <div class="suggestion-text">${suggestion.name}</div>
                        <div class="suggestion-category">${suggestion.category}</div>
                    </div>
                `;
                card.addEventListener('click', () => {
                    selectProduct(suggestion.key);
                });
                dropdown.appendChild(card);
            });
            
            dropdown.classList.add('active');
        }

        // Select a product and show categories
        function selectProduct(productKey) {
            const product = productDatabase[productKey];
            if (!product) return;
            
            // Check if product is in a supported category
            if (!product.supportedCategory || !SUPPORTED_CATEGORIES.includes(product.supportedCategory)) {
                // Show error message
                const input = document.getElementById('productInput');
                input.value = '';
                input.placeholder = 'This product category is not supported in the current MVP.';
                input.style.borderColor = '#ef4444';
                input.style.backgroundColor = '#fef2f2';
                
                // Reset after 3 seconds
                setTimeout(() => {
                    input.placeholder = 'Search for a product (e.g. Cricket Bat, Forklift, Safety Gloves)';
                    input.style.borderColor = '';
                    input.style.backgroundColor = '';
                }, 3000);
                
                // Hide autocomplete
                document.getElementById('autocompleteDropdown').classList.remove('active');
                return;
            }
            
            selectedProduct = product;
            document.getElementById('productInput').value = product.name;
            document.getElementById('autocompleteDropdown').classList.remove('active');
            
            // Reset selection state
            selectedType = null;
            selectedVariant = null;
            
            // Hide all content sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById('viewToggleSection').classList.remove('active');
            document.getElementById('exportSection').classList.remove('active');
            document.getElementById('variantsSection').classList.remove('active');
            
            // Hide any confirmation messages
            const categoryConfirmation = document.getElementById('categorySelectionConfirmation');
            const variantConfirmation = document.getElementById('variantSelectionConfirmation');
            if (categoryConfirmation) categoryConfirmation.classList.remove('active');
            if (variantConfirmation) variantConfirmation.classList.remove('active');
            
            // Show category section
            showCategorySection(product);
        }

        // Show category selection cards with beginner-friendly flow
        function showCategorySection(product) {
            const categorySection = document.getElementById('categorySection');
            const categoryGrid = document.getElementById('categoryGrid');
            
            // Find productId (key) from product object
            const productId = Object.keys(productDatabase).find(key => productDatabase[key] === product);
            
            // Add helpful hint for beginners
            const existingHint = categorySection.querySelector('.category-hint');
            if (existingHint) {
                existingHint.remove();
            }
            
            const hint = document.createElement('div');
            hint.className = 'category-hint';
            hint.innerHTML = '<span class="hint-icon">üí°</span> <span>Choose the type that matches your needs</span>';
            categorySection.insertBefore(hint, categoryGrid);
            
            categoryGrid.innerHTML = '';
            product.categories.forEach((category, index) => {
                const card = document.createElement('div');
                card.className = 'category-card';
                
                // Get image using new helper, fallback to gradient if none
                const imageUrl = getImageFor(productId, category.name);
                if (imageUrl) {
                    card.style.backgroundImage = `url(${imageUrl})`;
                } else {
                    // Fallback: clean gradient (no random photo)
                    card.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
                    card.style.display = 'flex';
                    card.style.alignItems = 'center';
                    card.style.justifyContent = 'center';
                    card.style.flexDirection = 'column';
                    card.style.gap = '8px';
                }
                
                // If no image, show icon prominently
                if (!imageUrl) {
                    card.innerHTML = `
                        <div style="font-size: 48px; margin-bottom: 8px;">${category.icon || 'üì¶'}</div>
                        <div class="category-card-content">
                            <div class="category-card-title">${category.name}</div>
                            <div class="category-card-desc">${category.desc}</div>
                        </div>
                    `;
                } else {
                    card.innerHTML = `
                        <div class="category-card-content">
                            <div class="category-card-title">${category.name}</div>
                            <div class="category-card-desc">${category.desc}</div>
                        </div>
                    `;
                }
                
                // Stagger animation for visual appeal
                card.style.opacity = '0';
                card.style.transform = 'translateY(10px)';
                setTimeout(() => {
                    card.style.transition = 'all 0.3s ease';
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, index * 50);
                
                card.addEventListener('click', () => {
                    // Remove selection from all cards
                    document.querySelectorAll('.category-card').forEach(c => {
                        c.classList.remove('selected');
                    });
                    // Add selection to clicked card
                    card.classList.add('selected');
                    
                    // Save selection state
                    selectedType = category;
                    
                    // Show confirmation message
                    const confirmation = document.getElementById('categorySelectionConfirmation');
                    const selectedName = document.getElementById('selectedCategoryName');
                    selectedName.textContent = category.name;
                    confirmation.classList.add('active');
                    
                    // Show variants section after a brief delay
                    setTimeout(() => {
                        showVariantsSection(product, category);
                    }, 300);
                });
                
                categoryGrid.appendChild(card);
            });
            
            categorySection.classList.add('active');
        }

        // Show variants section with beginner-friendly guidance
        function showVariantsSection(product, category) {
            const variantsSection = document.getElementById('variantsSection');
            const variantsContainer = document.getElementById('variantsContainer');
            const continueBtn = document.getElementById('continueBtn');
            const variantConfirmation = document.getElementById('variantSelectionConfirmation');
            
            // Hide category section
            document.getElementById('categorySection').classList.remove('active');
            
            // Reset variant selection state
            selectedVariant = null;
            
            // Clear previous variants and hide confirmation
            variantsContainer.innerHTML = '';
            variantConfirmation.classList.remove('active');
            
            // Disable Continue button initially
            continueBtn.disabled = true;
            
            // Add beginner-friendly hint
            const hint = document.createElement('div');
            hint.className = 'variants-hint';
            hint.innerHTML = '<span class="hint-icon">‚ú®</span> <span>Explore your options ‚Äî click any card to see details</span>';
            variantsContainer.appendChild(hint);
            
            // Check if category has variants
            if (category.variants && Object.keys(category.variants).length > 0) {
                // Create variant groups
                Object.entries(category.variants).forEach(([groupName, variants]) => {
                    const groupDiv = document.createElement('div');
                    groupDiv.className = 'variants-group';
                    
                    const groupTitle = document.createElement('div');
                    groupTitle.className = 'variants-group-title';
                    groupTitle.textContent = groupName;
                    groupDiv.appendChild(groupTitle);
                    
                    const variantsGrid = document.createElement('div');
                    variantsGrid.className = 'variants-grid';
                    
                    variants.forEach(variant => {
                        const card = document.createElement('div');
                        card.className = 'variant-card';
                        
                        // Get image using new helper, fallback to gradient if none
                        const productId = Object.keys(productDatabase).find(key => productDatabase[key] === product);
                        const imageUrl = getImageFor(productId, category.name, variant.label);
                        if (imageUrl) {
                            card.style.backgroundImage = `url(${imageUrl})`;
                        } else {
                            // Fallback: show icon + text instead of unrelated image
                            card.style.background = 'linear-gradient(135deg, #f9fafb 0%, #f3f4f6 100%)';
                            card.style.display = 'flex';
                            card.style.alignItems = 'center';
                            card.style.justifyContent = 'center';
                            card.style.flexDirection = 'column';
                            card.style.gap = '8px';
                        }
                        
                        // If no image, show icon prominently
                        if (!imageUrl) {
                            card.innerHTML = `
                                <div style="font-size: 36px; margin-bottom: 8px;">${category.icon || 'üì¶'}</div>
                                ${variant.tooltip ? `<div class="variant-card-tooltip">${variant.tooltip}</div>` : ''}
                                <div class="variant-card-label">
                                    <div class="variant-card-label-title">${variant.label}</div>
                                    ${variant.subtitle ? `<div class="variant-card-label-subtitle">${variant.subtitle}</div>` : ''}
                                </div>
                            `;
                        } else {
                            card.innerHTML = `
                                ${variant.tooltip ? `<div class="variant-card-tooltip">${variant.tooltip}</div>` : ''}
                                <div class="variant-card-label">
                                    <div class="variant-card-label-title">${variant.label}</div>
                                    ${variant.subtitle ? `<div class="variant-card-label-subtitle">${variant.subtitle}</div>` : ''}
                                </div>
                            `;
                        }
                        
                        // Add click handler for variant selection
                        card.addEventListener('click', () => {
                            // Remove selection from all variant cards in this group
                            variantsGrid.querySelectorAll('.variant-card').forEach(c => {
                                c.classList.remove('selected');
                            });
                            // Add selection to clicked card
                            card.classList.add('selected');
                            
                            // Save selection state
                            selectedVariant = variant;
                            
                            // Show confirmation message
                            const confirmation = document.getElementById('variantSelectionConfirmation');
                            const selectedName = document.getElementById('selectedVariantName');
                            const displayText = variant.subtitle 
                                ? `${variant.label} ‚Äì ${variant.subtitle}`
                                : variant.label;
                            selectedName.textContent = displayText;
                            confirmation.classList.add('active');
                            
                            // Enable Continue button
                            const continueBtn = document.getElementById('continueBtn');
                            continueBtn.disabled = false;
                            
                            // Smooth scroll to Continue button
                            setTimeout(() => {
                                continueBtn.scrollIntoView({ 
                                    behavior: 'smooth', 
                                    block: 'nearest' 
                                });
                            }, 100);
                        });
                        
                        variantsGrid.appendChild(card);
                    });
                    
                    groupDiv.appendChild(variantsGrid);
                    variantsContainer.appendChild(groupDiv);
                });
                
                continueBtn.style.display = 'block';
                continueBtn.onclick = () => {
                    if (!continueBtn.disabled && selectedType) {
                        // Use selectedType to ensure we analyze the correct category
                        analyzeProductCategory(product.name, selectedType.name);
                    }
                };
            } else {
                // No variants, show and enable Continue button immediately
                continueBtn.style.display = 'block';
                continueBtn.disabled = false;
                continueBtn.onclick = () => {
                    if (!continueBtn.disabled && selectedType) {
                        // Use selectedType to ensure we analyze the correct category
                        analyzeProductCategory(product.name, selectedType.name);
                    }
                };
            }
            
            // Show variants section
            variantsSection.classList.add('active');
        }

        // Analyze selected product category
        function analyzeProductCategory(productName, categoryName) {
            // Hide selection sections when analysis starts
            document.getElementById('categorySection').classList.remove('active');
            document.getElementById('variantsSection').classList.remove('active');
            
            // Use the full product name with category for analysis
            const fullProductName = `${productName} - ${categoryName}`;
            
            // Collect optional context if section is expanded
            const clarificationContent = document.getElementById('clarificationContent');
            if (clarificationContent.classList.contains('expanded')) {
                contextAnswers = collectContextAnswers();
            } else {
                contextAnswers = {};
            }
            
            // Reset to beginner view
            currentView = 'beginner';
            const beginnerBtn = document.getElementById('beginnerViewBtn');
            const expertBtn = document.getElementById('expertViewBtn');
            if (beginnerBtn) beginnerBtn.classList.add('active');
            if (expertBtn) expertBtn.classList.remove('active');
            
            // Display analysis
            displayProductInfo(fullProductName, contextAnswers, 'beginner');
        }

        // Generate questions based on product category
        function generateQuestions(categoryType, productName) {
            const questions = [];
            
            // Industry selector (optional, first question)
            questions.push({
                id: 'industry',
                label: 'Industry context (optional)',
                type: 'select',
                options: ['General / Consumer', 'E-commerce', 'Warehouse / Logistics', 'Manufacturing / Industrial', 'Technology / SaaS']
            });
            
            // Common question: Intended user
            questions.push({
                id: 'intendedUser',
                label: 'Intended user',
                type: 'select',
                options: ['Individual / Personal use', 'Business / Commercial use', 'Both']
            });

            if (categoryType === 'sports') {
                questions.push({
                    id: 'environment',
                    label: 'Primary environment of use',
                    type: 'select',
                    options: ['Indoor facilities', 'Outdoor spaces', 'Both indoor and outdoor', 'Competitive settings']
                });
                questions.push({
                    id: 'budget',
                    label: 'Priority consideration',
                    type: 'select',
                    options: ['Cost-first (budget-friendly options)', 'Quality-first (performance and durability)', 'Balanced approach']
                });
                questions.push({
                    id: 'constraints',
                    label: 'Specific constraints or requirements',
                    type: 'text',
                    placeholder: 'e.g., size restrictions, safety standards, age group'
                });
            } else if (categoryType === 'food') {
                questions.push({
                    id: 'environment',
                    label: 'Primary use context',
                    type: 'select',
                    options: ['Home consumption', 'Restaurant / Food service', 'Retail / Grocery', 'Special dietary needs']
                });
                questions.push({
                    id: 'budget',
                    label: 'Priority consideration',
                    type: 'select',
                    options: ['Cost-first (value options)', 'Quality-first (premium ingredients)', 'Balanced approach']
                });
                questions.push({
                    id: 'constraints',
                    label: 'Specific constraints or requirements',
                    type: 'text',
                    placeholder: 'e.g., dietary restrictions, storage limitations, shelf life needs'
                });
            } else if (categoryType === 'electronics') {
                questions.push({
                    id: 'environment',
                    label: 'Primary use environment',
                    type: 'select',
                    options: ['Home / Personal', 'Office / Business', 'Mobile / On-the-go', 'Industrial / Specialized']
                });
                questions.push({
                    id: 'budget',
                    label: 'Priority consideration',
                    type: 'select',
                    options: ['Cost-first (budget options)', 'Quality-first (premium features)', 'Balanced approach']
                });
                questions.push({
                    id: 'constraints',
                    label: 'Specific constraints or requirements',
                    type: 'text',
                    placeholder: 'e.g., compatibility needs, size/weight limits, power requirements'
                });
            } else if (categoryType === 'clothing') {
                questions.push({
                    id: 'environment',
                    label: 'Primary use context',
                    type: 'select',
                    options: ['Casual / Everyday', 'Professional / Business', 'Active / Sports', 'Special occasions']
                });
                questions.push({
                    id: 'budget',
                    label: 'Priority consideration',
                    type: 'select',
                    options: ['Cost-first (affordable options)', 'Quality-first (durability and materials)', 'Balanced approach']
                });
                questions.push({
                    id: 'constraints',
                    label: 'Specific constraints or requirements',
                    type: 'text',
                    placeholder: 'e.g., size requirements, care preferences, material sensitivities'
                });
            } else {
                questions.push({
                    id: 'environment',
                    label: 'Primary use environment',
                    type: 'select',
                    options: ['Home / Personal', 'Business / Commercial', 'Industrial', 'Specialized applications']
                });
                questions.push({
                    id: 'budget',
                    label: 'Priority consideration',
                    type: 'select',
                    options: ['Cost-first', 'Quality-first', 'Balanced approach']
                });
                questions.push({
                    id: 'constraints',
                    label: 'Specific constraints or requirements',
                    type: 'text',
                    placeholder: 'e.g., size, weight, safety, compliance needs'
                });
            }

            return questions;
        }


        // Collect answers from clarification form
        function collectContextAnswers() {
            const answers = {};
            const inputs = document.querySelectorAll('#questionsContainer select, #questionsContainer input[type="text"]');
            inputs.forEach(input => {
                if (input.value.trim()) {
                    answers[input.id] = input.value.trim();
                }
            });
            return answers;
        }

        // Get industry-specific terminology
        function getIndustryTerminology(industry) {
            const terms = {
                'E-commerce': {
                    purchase: 'purchase',
                    users: 'customers',
                    usage: 'customer experience',
                    selection: 'product selection',
                    considerations: 'customer satisfaction and return rates'
                },
                'Warehouse / Logistics': {
                    purchase: 'procurement',
                    users: 'operators',
                    usage: 'operational efficiency',
                    selection: 'supply chain integration',
                    considerations: 'throughput, handling requirements, and inventory management'
                },
                'Manufacturing / Industrial': {
                    purchase: 'procurement',
                    users: 'operators',
                    usage: 'production processes',
                    selection: 'production line integration',
                    considerations: 'durability, maintenance schedules, and compliance standards'
                },
                'Technology / SaaS': {
                    purchase: 'acquisition',
                    users: 'end users',
                    usage: 'user experience',
                    selection: 'technical specifications',
                    considerations: 'scalability, integration capabilities, and support requirements'
                },
                'General / Consumer': {
                    purchase: 'purchase',
                    users: 'users',
                    usage: 'usage',
                    selection: 'selection',
                    considerations: 'user needs and expectations'
                }
            };
            return terms[industry] || terms['General / Consumer'];
        }

        // Get industry-specific risks
        function getIndustryRisks(industry) {
            const risks = {
                'E-commerce': [
                    'Customer return rates and satisfaction metrics',
                    'Shipping and packaging compatibility',
                    'Product listing accuracy and compliance',
                    'Inventory management and stockout risks',
                    'Customer review and rating implications'
                ],
                'Warehouse / Logistics': [
                    'Operational efficiency and throughput impact',
                    'Storage space optimization and layout considerations',
                    'Handling equipment compatibility',
                    'Safety protocols and worker ergonomics',
                    'Inventory tracking and traceability requirements'
                ],
                'Manufacturing / Industrial': [
                    'Production line integration and downtime risks',
                    'Quality control and defect rates',
                    'Maintenance schedules and equipment compatibility',
                    'Regulatory compliance and safety standards',
                    'Supply chain reliability and vendor dependencies'
                ],
                'Technology / SaaS': [
                    'Integration complexity and API compatibility',
                    'Scalability limitations and performance bottlenecks',
                    'Security vulnerabilities and data protection',
                    'Vendor lock-in and migration challenges',
                    'Support and maintenance requirements'
                ],
                'General / Consumer': [
                    'Usage limits and safety considerations',
                    'Storage guidance and environmental conditions',
                    'Compatibility requirements',
                    'Maintenance needs'
                ]
            };
            return risks[industry] || risks['General / Consumer'];
        }

        // Get industry-specific usage examples
        function getIndustryUsageExamples(industry, categoryType, context) {
            const examples = {
                'E-commerce': {
                    sports: [
                        'Listed in online product catalogs with detailed specifications for customer browsing',
                        'Displayed in search results with filtering options for size, color, and price',
                        'Packaged for direct-to-consumer shipping with appropriate protection',
                        'Reviewed by customers with ratings and feedback affecting visibility',
                        'Managed in inventory systems with real-time stock level updates'
                    ],
                    food: [
                        'Listed in online grocery platforms with nutritional information and allergen warnings',
                        'Displayed in product search results with filtering by dietary preferences',
                        'Packaged for home delivery with temperature control considerations',
                        'Reviewed by customers with feedback on taste, quality, and value',
                        'Managed with expiration date tracking and rotation protocols'
                    ],
                    electronics: [
                        'Featured in online marketplaces with technical specifications and compatibility details',
                        'Displayed with comparison tools for features, price, and reviews',
                        'Shipped with appropriate packaging to prevent damage during transit',
                        'Reviewed by customers with focus on performance, reliability, and value',
                        'Managed with warranty and return policy considerations'
                    ],
                    clothing: [
                        'Displayed in online stores with size charts and fit guidance',
                        'Featured in product listings with multiple images and style variations',
                        'Packaged for shipping with appropriate folding and protection',
                        'Reviewed by customers with feedback on fit, quality, and appearance',
                        'Managed with size availability and inventory tracking'
                    ],
                    general: [
                        'Listed in online marketplaces with comprehensive product descriptions',
                        'Displayed in search results with relevant filtering and sorting options',
                        'Packaged appropriately for shipping and customer expectations',
                        'Reviewed by customers with ratings affecting product visibility',
                        'Managed in inventory systems with real-time availability updates'
                    ]
                },
                'Warehouse / Logistics': {
                    sports: [
                        'Stored in warehouse facilities with space optimization considerations',
                        'Handled using material handling equipment appropriate for weight and dimensions',
                        'Picked and packed according to order fulfillment workflows',
                        'Tracked through inventory management systems with barcode scanning',
                        'Shipped with appropriate packaging to prevent damage during transit'
                    ],
                    food: [
                        'Stored in temperature-controlled environments with expiration date tracking',
                        'Handled following food safety protocols and rotation procedures',
                        'Picked and packed with appropriate packaging for freshness',
                        'Tracked through inventory systems with lot number and batch tracking',
                        'Shipped with temperature control and handling instructions'
                    ],
                    electronics: [
                        'Stored in secure, climate-controlled areas with anti-static precautions',
                        'Handled with care to prevent damage to sensitive components',
                        'Picked and packed with protective packaging and anti-static materials',
                        'Tracked through inventory systems with serial number management',
                        'Shipped with appropriate protection and handling labels'
                    ],
                    clothing: [
                        'Stored in warehouse facilities with hanging or folded storage methods',
                        'Handled to prevent damage, wrinkling, or contamination',
                        'Picked and packed with appropriate folding and protection',
                        'Tracked through inventory systems with size and color variations',
                        'Shipped with appropriate packaging to maintain appearance'
                    ],
                    general: [
                        'Stored in warehouse facilities optimized for space and accessibility',
                        'Handled using appropriate equipment and procedures for product type',
                        'Picked and packed according to order specifications',
                        'Tracked through inventory management systems',
                        'Shipped with appropriate packaging and handling requirements'
                    ]
                },
                'Manufacturing / Industrial': {
                    sports: [
                        'Integrated into production processes for sports equipment manufacturing',
                        'Used in assembly lines with quality control checkpoints',
                        'Stored in production facilities with just-in-time inventory management',
                        'Tracked through manufacturing execution systems',
                        'Maintained according to production schedules and equipment requirements'
                    ],
                    food: [
                        'Used as ingredients or components in food production processes',
                        'Stored in production facilities with temperature and humidity control',
                        'Tracked through batch and lot management systems',
                        'Handled following food safety and hygiene protocols',
                        'Maintained with rotation procedures and expiration monitoring'
                    ],
                    electronics: [
                        'Integrated into electronic device assembly and manufacturing processes',
                        'Used in production lines with ESD protection and quality testing',
                        'Stored in controlled environments with anti-static precautions',
                        'Tracked through manufacturing execution systems with component traceability',
                        'Maintained with calibration and testing requirements'
                    ],
                    clothing: [
                        'Used in textile manufacturing and garment production processes',
                        'Stored in production facilities with appropriate environmental conditions',
                        'Tracked through production planning and inventory systems',
                        'Handled to prevent contamination or damage during manufacturing',
                        'Maintained according to production schedules and material requirements'
                    ],
                    general: [
                        'Integrated into manufacturing and production processes',
                        'Used in production lines with quality control procedures',
                        'Stored in production facilities with inventory management',
                        'Tracked through manufacturing execution systems',
                        'Maintained according to production schedules and requirements'
                    ]
                },
                'Technology / SaaS': {
                    sports: [
                        'Integrated into fitness tracking and sports analytics platforms',
                        'Used in mobile applications for workout planning and performance monitoring',
                        'Connected to IoT devices for real-time data collection',
                        'Managed through cloud-based inventory and analytics systems',
                        'Supported with API integrations for third-party services'
                    ],
                    food: [
                        'Tracked through food delivery and meal planning applications',
                        'Integrated into nutrition tracking and dietary management systems',
                        'Connected to smart kitchen devices and inventory management apps',
                        'Managed through cloud-based platforms for recipe and meal planning',
                        'Supported with API integrations for grocery and delivery services'
                    ],
                    electronics: [
                        'Integrated into device management and monitoring platforms',
                        'Connected to cloud services for data synchronization and backup',
                        'Used in IoT ecosystems with device-to-device communication',
                        'Managed through software-defined infrastructure and automation',
                        'Supported with API integrations and software development kits'
                    ],
                    clothing: [
                        'Tracked through fashion and wardrobe management applications',
                        'Integrated into e-commerce platforms with virtual try-on features',
                        'Connected to smart closet systems and inventory management apps',
                        'Managed through cloud-based platforms for style and outfit planning',
                        'Supported with API integrations for sizing and fit recommendations'
                    ],
                    general: [
                        'Integrated into digital platforms and software ecosystems',
                        'Connected to cloud services for data management and analytics',
                        'Used in applications with API integrations and third-party services',
                        'Managed through software platforms and automation systems',
                        'Supported with technical documentation and integration capabilities'
                    ]
                },
                'General / Consumer': {
                    sports: [
                        'Used during training sessions to practice and improve skills',
                        'Employed in competitive settings where performance and safety standards apply',
                        'Utilized for recreational activities in appropriate environments',
                        'Applied in fitness routines or exercise programs based on user goals',
                        'Engaged in group activities or team sports where coordination and safety are important'
                    ],
                    food: [
                        'Consumed as part of regular meals or snacks based on nutritional needs',
                        'Used as ingredients in recipes or meal preparation',
                        'Served in social settings or gatherings with appropriate portion considerations',
                        'Included in dietary plans that account for nutritional content and restrictions',
                        'Stored and prepared following food safety guidelines for optimal quality'
                    ],
                    electronics: [
                        'Operated in home or office environments for productivity and communication',
                        'Used for entertainment purposes such as media consumption or gaming',
                        'Employed in mobile settings where portability and battery life matter',
                        'Connected with other devices or networks for expanded functionality',
                        'Utilized in various lighting and environmental conditions appropriate to device specifications'
                    ],
                    clothing: [
                        'Worn in everyday settings appropriate to the garment style and occasion',
                        'Used for specific activities or environments where material properties are important',
                        'Worn in different weather conditions based on fabric characteristics',
                        'Selected for comfort and fit in various body positions and movements',
                        'Maintained through appropriate care routines to preserve appearance and durability'
                    ],
                    general: [
                        'Used in typical scenarios appropriate to the product category and intended purpose',
                        'Applied in various contexts where the product\'s core functionality is needed',
                        'Utilized by different user groups based on product suitability and design',
                        'Employed in environments that match the product\'s specifications and limitations',
                        'Maintained and stored according to recommendations for optimal performance and longevity'
                    ]
                }
            };
            
            const industryExamples = examples[industry] || examples['General / Consumer'];
            return industryExamples[categoryType] || industryExamples.general;
        }

        // Generate Important Considerations - key factors buyers often overlook
        function generateAIBlindSpots(categoryType, context, industry, productName) {
            const blindSpots = [];
            
            if (categoryType === 'sports') {
                blindSpots.push({
                    blindspot: 'proper sizing requirements and age-appropriate usage',
                    why: 'Product descriptions often focus on general features rather than individual fit and safety considerations',
                    consequence: 'Users may select incorrectly sized equipment, leading to injury risk or poor performance'
                });
                blindSpots.push({
                    blindspot: 'maintenance requirements for safety-critical components',
                    why: 'Product information emphasizes features but rarely covers ongoing care needed for safety',
                    consequence: 'Equipment may degrade unnoticed, creating hidden safety hazards during use'
                });
                blindSpots.push({
                    blindspot: 'environmental conditions that affect performance or durability',
                    why: 'Many product descriptions don\'t account for real-world weather, storage, or usage environments',
                    consequence: 'Products may fail prematurely or perform poorly in conditions they weren\'t designed for'
                });
                blindSpots.push({
                    blindspot: 'impact forces and stress points that could lead to equipment failure',
                    why: 'Product information often lacks details about physical mechanics and failure modes',
                    consequence: 'Unexpected equipment failure during high-intensity use can cause serious injury'
                });
            } else if (categoryType === 'food') {
                blindSpots.push({
                    blindspot: 'allergen content and cross-contamination risks',
                    why: 'AI systems often summarize ingredients without highlighting allergen implications',
                    consequence: 'Consumers with allergies may experience reactions due to incomplete information'
                });
                blindSpots.push({
                    blindspot: 'proper storage conditions to prevent spoilage or contamination',
                    why: 'AI descriptions focus on product features rather than practical storage requirements',
                    consequence: 'Food may spoil faster than expected or become unsafe to consume'
                });
                blindSpots.push({
                    blindspot: 'expiration dates and shelf-life considerations',
                    why: 'AI systems don\'t emphasize time-sensitive safety and quality factors',
                    consequence: 'Consumers may use expired products, risking foodborne illness or poor quality'
                });
                blindSpots.push({
                    blindspot: 'signs of spoilage or contamination',
                    why: 'AI descriptions don\'t teach users how to recognize when products are no longer safe',
                    consequence: 'People may consume unsafe food because they can\'t identify warning signs'
                });
            } else if (categoryType === 'electronics') {
                blindSpots.push({
                    blindspot: 'compatibility constraints with existing devices or systems',
                    why: 'AI systems describe features in isolation without considering integration requirements',
                    consequence: 'Users may purchase devices that don\'t work with their existing setup, wasting money'
                });
                blindSpots.push({
                    blindspot: 'power and charging requirements that affect daily usage',
                    why: 'AI focuses on features but not practical power management needs',
                    consequence: 'Devices may not meet usage demands, requiring frequent charging or power adapters'
                });
                blindSpots.push({
                    blindspot: 'environmental operating conditions and temperature limits',
                    why: 'AI descriptions don\'t emphasize environmental constraints that affect performance',
                    consequence: 'Devices may malfunction or fail when used outside recommended conditions'
                });
                blindSpots.push({
                    blindspot: 'battery safety considerations and degradation over time',
                    why: 'AI systems don\'t explain long-term battery behavior and safety implications',
                    consequence: 'Batteries may degrade unexpectedly or pose safety risks if not properly maintained'
                });
            } else if (categoryType === 'clothing') {
                blindSpots.push({
                    blindspot: 'proper sizing and fit guidance for different body types',
                    why: 'AI systems provide generic size information without accounting for fit variations',
                    consequence: 'Clothing may not fit properly, leading to discomfort, poor appearance, or returns'
                });
                blindSpots.push({
                    blindspot: 'care instructions that preserve quality and appearance',
                    why: 'AI descriptions focus on style but not maintenance requirements',
                    consequence: 'Clothing may shrink, fade, or deteriorate faster than expected with improper care'
                });
                blindSpots.push({
                    blindspot: 'material-specific limitations and durability expectations',
                    why: 'AI systems don\'t explain how different materials behave over time',
                    consequence: 'Users may have unrealistic expectations about how long items will last'
                });
                blindSpots.push({
                    blindspot: 'suitability for different occasions or environments',
                    why: 'AI focuses on style descriptions rather than practical usage contexts',
                    consequence: 'Clothing may be inappropriate for intended occasions or environments'
                });
            } else {
                blindSpots.push({
                    blindspot: 'usage limits and environmental conditions',
                    why: 'AI systems describe capabilities without explaining constraints',
                    consequence: 'Products may fail or perform poorly when used beyond their intended limits'
                });
                blindSpots.push({
                    blindspot: 'storage requirements and handling procedures',
                    why: 'AI focuses on features rather than practical maintenance and storage needs',
                    consequence: 'Products may degrade or become damaged due to improper storage or handling'
                });
                blindSpots.push({
                    blindspot: 'compatibility requirements with other products or systems',
                    why: 'AI descriptions don\'t emphasize integration and compatibility needs',
                    consequence: 'Products may not work as expected when integrated with existing systems'
                });
                blindSpots.push({
                    blindspot: 'maintenance needs and signs of wear or deterioration',
                    why: 'AI systems don\'t explain ongoing care requirements or warning signs',
                    consequence: 'Products may fail unexpectedly or require costly repairs due to lack of maintenance'
                });
            }
            
            // Add industry-specific blind spots
            if (industry === 'E-commerce') {
                blindSpots.push({
                    blindspot: 'return rates and customer satisfaction factors',
                    why: 'AI systems don\'t analyze real customer feedback and return patterns',
                    consequence: 'Sellers may stock products with high return rates, impacting profitability'
                });
            } else if (industry === 'Warehouse / Logistics') {
                blindSpots.push({
                    blindspot: 'operational efficiency and handling requirements',
                    why: 'AI systems don\'t consider warehouse workflows and logistics constraints',
                    consequence: 'Products may slow down operations or require expensive handling equipment'
                });
            } else if (industry === 'Manufacturing / Industrial') {
                blindSpots.push({
                    blindspot: 'production line integration and downtime risks',
                    why: 'AI systems don\'t evaluate impact on manufacturing processes',
                    consequence: 'Products may cause production delays or require expensive modifications'
                });
            } else if (industry === 'Technology / SaaS') {
                blindSpots.push({
                    blindspot: 'integration complexity and scalability limitations',
                    why: 'AI systems don\'t assess technical integration challenges',
                    consequence: 'Products may require extensive customization or fail to scale with business growth'
                });
            }
            
            // Return 3-5 blind spots
            return blindSpots.slice(0, 5);
        }

        // Generate "Who This Product Is NOT Suitable For" content
        function generateNotSuitableContent(categoryType, context, industry, productName) {
            const notSuitable = [];
            
            if (categoryType === 'sports') {
                notSuitable.push('Users who require equipment outside the recommended age or skill level range, as improper sizing or capability mismatch can lead to safety risks');
                notSuitable.push('Environments with extreme weather conditions or surfaces that exceed the product\'s design specifications, which could cause premature failure or safety hazards');
                notSuitable.push('High-intensity competitive use when the product is designed for recreational purposes, as it may not withstand the demands of competitive settings');
                notSuitable.push('Users with specific medical conditions or physical limitations that require specialized equipment, as standard products may not provide necessary support or safety features');
                if (context.budget && context.budget.includes('Cost-first')) {
                    notSuitable.push('Frequent, high-intensity use where premium durability and performance features would be necessary to prevent frequent replacement or safety issues');
                }
            } else if (categoryType === 'food') {
                notSuitable.push('Individuals with specific food allergies or dietary restrictions that are not clearly addressed in the product formulation, as cross-contamination risks may exist');
                notSuitable.push('Storage environments that cannot maintain required temperature, humidity, or light conditions, which could lead to spoilage, contamination, or quality degradation');
                notSuitable.push('Use beyond expiration dates or recommended shelf life, as food safety and quality cannot be guaranteed after these periods');
                notSuitable.push('Specialized dietary needs requiring precise nutritional profiles or medical-grade formulations, as standard products may not meet these specific requirements');
                if (context.environment && context.environment.includes('Special dietary')) {
                    notSuitable.push('General consumption without careful review of ingredients, as specialized formulations may not be suitable for all dietary needs');
                }
            } else if (categoryType === 'electronics') {
                notSuitable.push('Environments with extreme temperatures, humidity, or exposure to water beyond the device\'s IP rating, which could cause permanent damage or safety hazards');
                notSuitable.push('Use with incompatible operating systems, software versions, or peripheral devices, as compatibility issues can lead to malfunctions or data loss');
                notSuitable.push('Applications requiring performance capabilities beyond the device\'s specifications, which could result in overheating, reduced lifespan, or failure');
                notSuitable.push('Users who cannot provide appropriate power sources, charging infrastructure, or maintenance, as improper power management can damage devices');
                if (context.budget && context.budget.includes('Cost-first')) {
                    notSuitable.push('Heavy-duty or professional applications requiring premium reliability and extended support, as budget models may lack necessary durability or warranty coverage');
                }
            } else if (categoryType === 'clothing') {
                notSuitable.push('Activities or environments that require specialized protective gear or performance fabrics beyond the garment\'s design specifications');
                notSuitable.push('Users who cannot follow recommended care instructions, as improper washing, drying, or storage can cause damage, shrinkage, or color fading');
                notSuitable.push('Extreme weather conditions or environments that exceed the fabric\'s temperature, moisture, or durability ratings');
                notSuitable.push('Situations requiring specific fit, sizing, or body coverage that the product cannot accommodate, as improper fit can affect comfort, appearance, or safety');
                if (context.environment && context.environment.includes('Professional')) {
                    notSuitable.push('Casual or athletic settings where professional appearance standards are not required, as the investment may not align with usage patterns');
                }
            } else {
                notSuitable.push('Use cases that exceed the product\'s intended purpose or design specifications, which could lead to failure, safety risks, or voided warranties');
                notSuitable.push('Environments or conditions that do not meet the product\'s operating requirements, such as temperature, humidity, or space constraints');
                notSuitable.push('Users who cannot provide necessary maintenance, storage, or handling requirements, as improper care can compromise product integrity');
                notSuitable.push('Applications requiring specialized features, certifications, or performance levels that the product does not offer');
            }
            
            // Add industry-specific not suitable cases
            if (industry === 'E-commerce') {
                notSuitable.push('High-volume sellers requiring bulk purchasing capabilities or specialized fulfillment features that standard product listings may not support');
                notSuitable.push('Markets with strict regulatory requirements or compliance standards that the product may not meet without additional verification');
            } else if (industry === 'Warehouse / Logistics') {
                notSuitable.push('Facilities with space constraints or handling equipment limitations that cannot accommodate the product\'s dimensions or weight requirements');
                notSuitable.push('Operations requiring specialized tracking, serialization, or inventory management features that standard products may not provide');
            } else if (industry === 'Manufacturing / Industrial') {
                notSuitable.push('Production processes requiring specific certifications, tolerances, or quality standards that the product may not meet');
                notSuitable.push('Operations with equipment compatibility requirements or integration needs that standard products cannot fulfill');
            } else if (industry === 'Technology / SaaS') {
                notSuitable.push('Systems requiring specific API integrations, data formats, or security protocols that the product does not support');
                notSuitable.push('Applications with scalability requirements or performance demands beyond the product\'s capabilities');
            }
            
            // Add context-specific not suitable cases
            if (context.intendedUser && context.intendedUser.includes('Individual')) {
                notSuitable.push('Business or commercial applications requiring bulk purchasing, commercial warranties, or enterprise support features');
            } else if (context.intendedUser && context.intendedUser.includes('Business')) {
                notSuitable.push('Personal or individual use cases where commercial-grade features and pricing may be unnecessary or cost-prohibitive');
            }
            
            if (context.constraints) {
                notSuitable.push(`Use cases that conflict with the specified constraint: ${context.constraints}, as the product may not accommodate these requirements`);
            }
            
            return notSuitable;
        }

        // Generate visual comparison cards data
        function generateVisualComparisons(productName, categoryType) {
            const nameLower = productName.toLowerCase();
            const comparisons = [];
            
            // Cricket Bat comparisons
            if (nameLower.includes('cricket bat') || nameLower.includes('bat')) {
                comparisons.push({
                    title: 'Leather Ball Bat',
                    image: 'images/cricket/leather-bat.jpg',
                    bestFor: 'Professional matches and competitive cricket',
                    durability: 'High',
                    beginnerFriendly: 'No'
                });
                comparisons.push({
                    title: 'Tennis Ball Bat',
                    image: 'images/cricket/tennis-bat.jpg',
                    bestFor: 'Casual play and practice sessions',
                    durability: 'Medium',
                    beginnerFriendly: 'Yes'
                });
                comparisons.push({
                    title: 'Plastic Ball Bat',
                    image: 'images/cricket/plastic-bat.jpg',
                    bestFor: 'Beginners and children',
                    durability: 'Low',
                    beginnerFriendly: 'Yes'
                });
            }
            // Safety Gloves comparisons
            else if (nameLower.includes('glove') || nameLower.includes('safety')) {
                comparisons.push({
                    title: 'Cut-Resistant Gloves',
                    image: 'https://images.unsplash.com/photo-1581578731548-c64695cc6952?w=400&h=300&fit=crop',
                    bestFor: 'Handling sharp objects and blades',
                    durability: 'High',
                    beginnerFriendly: 'Yes'
                });
                comparisons.push({
                    title: 'Chemical-Resistant Gloves',
                    image: 'https://images.unsplash.com/photo-1581578731548-c64695cc6952?w=400&h=300&fit=crop',
                    bestFor: 'Handling hazardous chemicals',
                    durability: 'High',
                    beginnerFriendly: 'No'
                });
                comparisons.push({
                    title: 'General Purpose Gloves',
                    image: 'https://images.unsplash.com/photo-1581578731548-c64695cc6952?w=400&h=300&fit=crop',
                    bestFor: 'Multi-purpose protection tasks',
                    durability: 'Medium',
                    beginnerFriendly: 'Yes'
                });
            }
            // Forklift comparisons
            else if (nameLower.includes('forklift')) {
                comparisons.push({
                    title: 'Electric Forklift',
                    image: 'https://images.unsplash.com/photo-1586528116311-ad8dd3c8310d?w=400&h=300&fit=crop',
                    bestFor: 'Indoor use with zero emissions',
                    durability: 'High',
                    beginnerFriendly: 'Yes'
                });
                comparisons.push({
                    title: 'Diesel Forklift',
                    image: 'https://images.unsplash.com/photo-1586528116311-ad8dd3c8310d?w=400&h=300&fit=crop',
                    bestFor: 'Heavy-duty outdoor operations',
                    durability: 'High',
                    beginnerFriendly: 'No'
                });
                comparisons.push({
                    title: 'Pallet Jack',
                    image: 'https://images.unsplash.com/photo-1586528116311-ad8dd3c8310d?w=400&h=300&fit=crop',
                    bestFor: 'Manual handling for smaller loads',
                    durability: 'Medium',
                    beginnerFriendly: 'Yes'
                });
            }
            // Laptop comparisons
            else if (nameLower.includes('laptop')) {
                comparisons.push({
                    title: 'Business Laptop',
                    image: 'https://images.unsplash.com/photo-1496181133206-80ce9b88a853?w=400&h=300&fit=crop',
                    bestFor: 'Professional use and productivity',
                    durability: 'High',
                    beginnerFriendly: 'Yes'
                });
                comparisons.push({
                    title: 'Gaming Laptop',
                    image: 'https://images.unsplash.com/photo-1496181133206-80ce9b88a853?w=400&h=300&fit=crop',
                    bestFor: 'High-performance gaming',
                    durability: 'High',
                    beginnerFriendly: 'No'
                });
                comparisons.push({
                    title: 'Student Laptop',
                    image: 'https://images.unsplash.com/photo-1496181133206-80ce9b88a853?w=400&h=300&fit=crop',
                    bestFor: 'Education and basic tasks',
                    durability: 'Medium',
                    beginnerFriendly: 'Yes'
                });
            }
            // Racket comparisons
            else if (nameLower.includes('racket')) {
                comparisons.push({
                    title: 'Tennis Racket',
                    image: 'https://images.unsplash.com/photo-1622163642999-958314b993f3?w=400&h=300&fit=crop',
                    bestFor: 'Tennis court play',
                    durability: 'High',
                    beginnerFriendly: 'Yes'
                });
                comparisons.push({
                    title: 'Badminton Racket',
                    image: 'https://images.unsplash.com/photo-1622163642999-958314b993f3?w=400&h=300&fit=crop',
                    bestFor: 'Badminton courts',
                    durability: 'Medium',
                    beginnerFriendly: 'Yes'
                });
                comparisons.push({
                    title: 'Squash Racket',
                    image: 'https://images.unsplash.com/photo-1622163642999-958314b993f3?w=400&h=300&fit=crop',
                    bestFor: 'Squash courts',
                    durability: 'High',
                    beginnerFriendly: 'No'
                });
            }
            
            return comparisons;
        }

        // Generate comparison insights
        function generateComparisonInsight(categoryType, context, industry) {
            const comparisons = [];
            
            // Budget vs Premium comparison
            const budgetComparison = {
                title: 'Budget vs Premium Variants',
                content: ''
            };
            
            if (categoryType === 'sports') {
                budgetComparison.content = `Budget variants typically offer essential functionality with standard materials, suitable for occasional use or beginners. Premium variants provide enhanced durability, advanced materials, and performance features designed for frequent use or competitive settings. The trade-off involves balancing initial cost against long-term durability and performance needs.`;
            } else if (categoryType === 'food') {
                budgetComparison.content = `Budget options focus on value and basic nutritional requirements, often with simpler ingredient lists. Premium variants may include organic ingredients, specialized formulations, or enhanced nutritional profiles. Consider whether the additional cost aligns with dietary goals, quality preferences, or specific health requirements.`;
            } else if (categoryType === 'electronics') {
                budgetComparison.content = `Budget models provide core functionality with standard features and performance. Premium variants offer advanced capabilities, better build quality, extended warranties, and enhanced performance. Evaluate whether the additional features justify the cost based on your usage intensity and specific requirements.`;
            } else if (categoryType === 'clothing') {
                budgetComparison.content = `Budget options use standard materials and construction suitable for occasional wear. Premium variants feature higher-quality fabrics, better construction techniques, and enhanced durability. Consider your usage frequency, care preferences, and how long you expect the item to remain in good condition.`;
            } else {
                budgetComparison.content = `Budget variants prioritize cost-effectiveness with standard features and materials. Premium options offer enhanced quality, durability, and additional features. Assess whether the premium features align with your usage patterns, longevity expectations, and specific needs.`;
            }
            comparisons.push(budgetComparison);
            
            // Size/Capacity comparison
            const sizeComparison = {
                title: 'Size and Capacity Options',
                content: ''
            };
            
            if (categoryType === 'sports') {
                sizeComparison.content = `Size options directly impact fit, safety, and performance. Smaller sizes may be more maneuverable but could compromise safety if too small. Larger sizes offer more coverage or capacity but may affect agility or comfort. Select based on user measurements, activity type, and manufacturer sizing guidelines to ensure proper fit and safety.`;
            } else if (categoryType === 'food') {
                sizeComparison.content = `Package sizes affect value, storage requirements, and consumption patterns. Smaller packages offer freshness and portion control but higher per-unit cost. Larger packages provide better value but require appropriate storage conditions and consumption planning to prevent waste. Consider household size, consumption rate, and storage capacity.`;
            } else if (categoryType === 'electronics') {
                sizeComparison.content = `Storage capacity and screen size options balance portability with functionality. Smaller devices offer better portability but may limit storage or display capabilities. Larger options provide more capacity and better viewing but reduced portability. Match capacity to your data needs and screen size to your usage environment.`;
            } else if (categoryType === 'clothing') {
                sizeComparison.content = `Size selection impacts fit, comfort, and appearance. Sizes that are too small may restrict movement or cause discomfort, while oversized items may look unprofessional or interfere with activities. Refer to manufacturer size charts and consider fit preferences (slim, regular, relaxed) for optimal selection.`;
            } else {
                sizeComparison.content = `Size and capacity options balance functionality with practical constraints. Smaller variants may be more portable or space-efficient but could limit capabilities. Larger options offer more capacity or features but may require more storage space or handling considerations. Evaluate based on your space constraints, usage requirements, and portability needs.`;
            }
            comparisons.push(sizeComparison);
            
            // Suitability trade-offs
            const tradeoffComparison = {
                title: 'Suitability Trade-offs: Cost vs Durability vs Performance',
                content: ''
            };
            
            if (categoryType === 'sports') {
                tradeoffComparison.content = `Cost-effective options may require more frequent replacement but are suitable for occasional use. Durable variants offer longer lifespan and better performance but at higher initial cost. High-performance options excel in competitive settings but may be unnecessary for recreational use. Balance your activity frequency, skill level, and budget to find the optimal point.`;
            } else if (categoryType === 'food') {
                tradeoffComparison.content = `Lower-cost options may have simpler formulations but meet basic nutritional needs. Premium variants often offer better ingredient quality and nutritional profiles but at higher cost. Consider your dietary requirements, quality preferences, and budget constraints. For regular consumption, investing in quality may provide better long-term value.`;
            } else if (categoryType === 'electronics') {
                tradeoffComparison.content = `Budget models provide adequate performance for basic tasks but may lack advanced features or longevity. Mid-range options balance cost and performance for most users. Premium models offer superior performance and durability but may include features you won't utilize. Match the performance level to your actual usage patterns rather than maximum capabilities.`;
            } else if (categoryType === 'clothing') {
                tradeoffComparison.content = `Affordable options work well for occasional wear but may show wear more quickly. Mid-range items balance cost and durability for regular use. Premium options offer superior materials and construction for extended longevity. Consider how often you'll wear the item, care requirements, and whether the durability justifies the cost for your usage pattern.`;
            } else {
                tradeoffComparison.content = `Budget options meet basic needs but may have shorter lifespans or limited features. Mid-range selections balance cost, durability, and performance for typical use cases. Premium variants offer enhanced durability and performance but require evaluating whether the benefits justify the additional cost for your specific requirements.`;
            }
            comparisons.push(tradeoffComparison);
            
            // Industry-specific considerations
            if (industry === 'E-commerce') {
                comparisons.push({
                    title: 'E-commerce Considerations',
                    content: `For online sales, consider how product variants affect customer decision-making. Clear size guides and variant descriptions reduce return rates. Budget options may attract price-sensitive customers but could impact satisfaction. Premium variants may justify higher prices with detailed specifications and quality assurance information.`
                });
            } else if (industry === 'Warehouse / Logistics') {
                comparisons.push({
                    title: 'Operational Efficiency Factors',
                    content: `Evaluate variants based on storage density, handling requirements, and inventory turnover. Standardized sizes improve space utilization and picking efficiency. Consider how variant selection affects warehouse operations, inventory management complexity, and fulfillment speed. Bulk options may reduce handling but require appropriate storage capacity.`
                });
            } else if (industry === 'Manufacturing / Industrial') {
                comparisons.push({
                    title: 'Production Integration Factors',
                    content: `Consider how variants integrate with existing production processes and equipment compatibility. Standard sizes may improve supply chain reliability and reduce setup time. Premium materials may reduce maintenance frequency and downtime. Evaluate total cost of ownership including maintenance, replacement frequency, and production impact.`
                });
            } else if (industry === 'Technology / SaaS') {
                comparisons.push({
                    title: 'Technical Integration Considerations',
                    content: `Assess variants based on integration complexity, scalability requirements, and feature needs. Basic options may suffice for simple use cases but could limit future expansion. Premium variants offer better scalability and integration capabilities but require evaluating whether advanced features align with current and projected needs.`
                });
            }
            
            return comparisons;
        }

        // Generate Beginner Summary - 5-line simplified takeaway
        function generateBeginnerSummary(productName, categoryType, context, industry, overview, attributes, comparisons) {
            const summary = [];
            
            // Line 1: What it is (simple)
            summary.push(`This is ${productName} - a ${categoryType === 'sports' ? 'sports item' : categoryType === 'food' ? 'food product' : categoryType === 'electronics' ? 'device' : categoryType === 'clothing' ? 'piece of clothing' : 'product'} that does its job well.`);
            
            // Line 2: Key thing to know
            if (categoryType === 'sports') {
                summary.push(`Make sure it fits you properly and matches your skill level to stay safe.`);
            } else if (categoryType === 'food') {
                summary.push(`Check ingredients for allergies and store it correctly to keep it fresh.`);
            } else if (categoryType === 'electronics') {
                summary.push(`Make sure it works with your other devices and you have the right power setup.`);
            } else if (categoryType === 'clothing') {
                summary.push(`Pick the right size and follow care instructions to make it last.`);
            } else {
                summary.push(`Read the basics about how to use it and what it needs to work properly.`);
            }
            
            // Line 3: Main trade-off
            if (context.budget && context.budget.includes('Cost-first')) {
                summary.push(`Budget options save money now but may need replacing sooner than premium versions.`);
            } else if (context.budget && context.budget.includes('Quality-first')) {
                summary.push(`Premium options cost more upfront but usually last longer and work better.`);
            } else {
                summary.push(`You can find options at different price points - cheaper ones work fine for basic use.`);
            }
            
            // Line 4: What AI often misses
            if (categoryType === 'sports' || categoryType === 'food') {
                summary.push(`AI descriptions often skip safety details - always check sizing, storage, or handling requirements yourself.`);
            } else {
                summary.push(`AI descriptions often miss important details like compatibility, maintenance needs, or usage limits.`);
            }
            
            // Line 5: Bottom line
            summary.push(`Bottom line: This product works well for most people, but make sure it fits your specific needs and situation.`);
            
            return summary;
        }

        // Generate product-agnostic content based on product name and context
        function generateContent(productName, context = {}) {
            const name = productName.trim();
            const nameLower = name.toLowerCase();
            
            // Product Overview - plain-language summary for beginners
            const industry = context.industry || 'General / Consumer';
            const terminology = getIndustryTerminology(industry);
            let userContext = context.intendedUser || 'general users';
            let envContext = context.environment || 'typical environments';
            let budgetContext = context.budget || 'standard considerations';
            
            // Plain language overview for beginners - 1-2 sentences max
            let overview = `${name} is a ${budgetContext.includes('Cost-first') ? 'budget-friendly' : budgetContext.includes('Quality-first') ? 'quality' : 'standard'} option for ${userContext.includes('Individual') ? 'personal' : userContext.includes('Business') ? 'business' : 'everyday'} use. `;
            overview += `It works well for most people and does what it's supposed to do.`;
            
            if (context.constraints) {
                overview += ` Note: ${context.constraints.toLowerCase()}.`;
            }
            
            // Detect product category and determine category type
            let categoryType = 'general';
            let categoryAttributes = [];
            let categoryDimensions = [];
            let categoryInsight = '';
            
            // Sports equipment / fitness
            if (nameLower.match(/\b(ball|racket|bat|helmet|glove|shoe|sneaker|equipment|fitness|sport|athletic|gym|workout)\b/)) {
                categoryType = 'sports';
                categoryAttributes = [
                    'Made from durable materials like wood, plastic, or composite',
                    'Comes in different sizes to fit different people',
                    'Suitable for beginners and experienced users'
                ];
                categoryDimensions = [
                    'Available in different sizes (small, medium, large)',
                    'Different weights available',
                    'Various colors and styles'
                ];
                categoryInsight = `General AI-generated explanations of ${name} commonly overlook critical safety and handling considerations such as proper sizing for injury prevention, age-appropriate usage, maintenance requirements for safety-critical components, and environmental conditions that affect performance or durability. AI explanations often fail to mention important handling practices like proper grip techniques, safe storage to prevent damage or degradation, inspection procedures before use, and awareness of impact forces or stress points that could lead to equipment failure. This platform audits AI-generated content to highlight missing context about misuse risks, safety limitations, proper handling procedures, and usage conditions specific to sports equipment.`;
            }
            // Food / consumables
            else if (nameLower.match(/\b(food|snack|cereal|beverage|drink|ingredient|organic|natural|nutrition|meal|recipe)\b/)) {
                categoryType = 'food';
                categoryAttributes = [
                    'Contains standard ingredients for this type of product',
                    'May contain common allergens (check label)',
                    'Store in a cool, dry place'
                ];
                categoryDimensions = [
                    'Available in single-serve, family-size, or bulk',
                    'Different flavors and varieties',
                    'Check expiration date before use'
                ];
                categoryInsight = `General AI-generated explanations of ${name} commonly overlook critical safety and handling information such as allergen content, proper storage conditions to prevent spoilage or contamination, expiration and shelf-life considerations, dietary restrictions, and potential food safety risks. AI explanations often fail to mention important handling practices like safe preparation methods, temperature control during storage and serving, cross-contamination prevention, proper hygiene when handling, and recognition of signs of spoilage or contamination. This platform audits AI-generated content to highlight missing context about safety considerations, proper handling procedures, storage limitations, and misuse risks specific to food products.`;
            }
            // Electronics / tech
            else if (nameLower.match(/\b(phone|tablet|laptop|computer|device|electronic|tech|charger|cable|battery|screen|display|gadget)\b/)) {
                categoryType = 'electronics';
                categoryAttributes = [
                    'Works with standard devices and software',
                    'Needs power (battery or plug-in)',
                    'Compatible with common accessories'
                ];
                categoryDimensions = [
                    'Different storage sizes available',
                    'Various models with different features',
                    'Multiple color options'
                ];
                categoryInsight = `General AI-generated explanations of ${name} commonly overlook critical technical limitations and safety considerations such as compatibility constraints, power and charging requirements, environmental operating conditions, data security considerations, and warranty or support limitations. AI explanations often fail to mention important handling practices like proper charging procedures to prevent overheating, safe storage to avoid physical damage, protection from moisture or extreme temperatures, appropriate handling to prevent drops or impacts, and awareness of battery safety considerations. This platform audits AI-generated content to highlight missing context about compatibility risks, usage limitations, proper handling procedures, and potential misuse scenarios specific to electronic devices.`;
            }
            // Clothing / apparel
            else if (nameLower.match(/\b(shirt|pants|dress|jacket|clothing|apparel|fabric|textile|garment|wear)\b/)) {
                categoryType = 'clothing';
                categoryAttributes = [
                    'Made from materials like cotton, polyester, or blends',
                    'Available in standard sizes (S, M, L, XL)',
                    'Follow care label instructions'
                ];
                categoryDimensions = [
                    'Sizes from small to extra-large',
                    'Various colors and patterns',
                    'Different styles and fits available'
                ];
                categoryInsight = `General AI-generated explanations of ${name} commonly overlook important considerations and safety aspects such as proper sizing and fit guidance, care instructions to maintain quality, material-specific limitations, durability expectations, and suitability for different occasions or environments. AI explanations often fail to mention important handling practices like proper washing techniques to preserve fabric integrity, safe storage to prevent damage or discoloration, awareness of material-specific care requirements, recognition of signs of wear or damage, and appropriate handling of delicate or specialized materials. This platform audits AI-generated content to highlight missing context about care limitations, fit considerations, proper handling procedures, and usage constraints specific to clothing and apparel.`;
            }
            // Default / general products
            else {
                categoryAttributes = [
                    'Made from standard materials for this product type',
                    'Meets typical quality standards',
                    'Designed for everyday use'
                ];
                categoryDimensions = [
                    'Available in standard sizes',
                    'Different colors and styles',
                    'Various options to choose from'
                ];
                categoryInsight = `General AI-generated explanations of ${name} commonly overlook important context including safety and handling considerations such as usage limits, storage guidance, environmental conditions, compatibility requirements, and maintenance needs. AI explanations often fail to mention important handling practices like proper storage methods to preserve product integrity, safe handling techniques to prevent damage or injury, awareness of material limitations or degradation factors, recognition of signs of wear or deterioration, and appropriate usage conditions for optimal performance and safety. This platform audits AI-generated content to highlight missing context, safety considerations, proper handling procedures, limitations, and misuse risks specific to this product category.`;
            }
            
            // Key Attributes - simple for beginners
            let attributes = [...categoryAttributes];
            
            // Technical details - hidden by default
            let technicalDetails = [];
            if (industry === 'E-commerce') {
                technicalDetails.push('Product listing compatibility and digital catalog integration');
                technicalDetails.push('Customer review and rating considerations');
            } else if (industry === 'Warehouse / Logistics') {
                technicalDetails.push('Storage and handling efficiency specifications');
                technicalDetails.push('Inventory management and tracking compatibility');
            } else if (industry === 'Manufacturing / Industrial') {
                technicalDetails.push('Production line integration and compatibility requirements');
                technicalDetails.push('Quality control and compliance specifications');
            } else if (industry === 'Technology / SaaS') {
                technicalDetails.push('API and integration capabilities');
                technicalDetails.push('Scalability and performance specifications');
            }
            
            if (context.intendedUser && context.intendedUser.includes('Business')) {
                technicalDetails.push('Commercial-grade specifications suitable for business use');
            }
            if (context.budget && context.budget.includes('Quality-first')) {
                technicalDetails.push('Premium materials and construction for enhanced durability');
            } else if (context.budget && context.budget.includes('Cost-first')) {
                technicalDetails.push('Value-oriented specifications balancing cost and functionality');
            }
            
            // Dimensions / Variants - use category-specific dimensions, tailored by context
            let dimensions = [...categoryDimensions];
            
            if (context.environment) {
                dimensions.push(`Variants optimized for ${context.environment.toLowerCase()} are typically available`);
            }
            
            // How It's Used - real-world use cases based on industry and category
            let useCases = getIndustryUsageExamples(industry, categoryType, context);
            const steps = useCases;
            
            // AI Insight - use category-specific insight, enhanced with industry and context
            let insight = categoryInsight;
            
            // Add industry-specific risks
            if (industry !== 'General / Consumer') {
                const industryRisks = getIndustryRisks(industry);
                insight += ` In ${industry} contexts, AI-generated explanations commonly overlook industry-specific risks such as ${industryRisks.slice(0, 2).join(', ')}, and ${industryRisks[2]}.`;
            }
            
            // Add context-specific considerations to insight
            if (context.intendedUser && context.intendedUser.includes('Business')) {
                insight += ` For business use, AI explanations often miss commercial considerations such as bulk purchasing implications, compliance requirements, vendor support expectations, and scalability factors.`;
            }
            if (context.budget && context.budget.includes('Cost-first')) {
                insight += ` When prioritizing cost, AI-generated content frequently overlooks trade-offs between price and quality, long-term value considerations, and potential hidden costs.`;
            } else if (context.budget && context.budget.includes('Quality-first')) {
                insight += ` For quality-focused selections, AI explanations may not adequately address premium feature trade-offs, maintenance requirements for high-end products, or value justification.`;
            }
            if (context.constraints) {
                insight += ` Given specific constraints like "${context.constraints}", AI-generated explanations often fail to address how these limitations impact product selection, usage, or safety considerations.`;
            }
            
            // Comparison Insight
            const comparisons = generateComparisonInsight(categoryType, context, industry);
            
            // Who This Product Is NOT Suitable For
            const notSuitable = generateNotSuitableContent(categoryType, context, industry, name);
            
            // AI Blind Spots - specific things AI misses
            const aiBlindSpots = generateAIBlindSpots(categoryType, context, industry, name);
            
            // Beginner Summary - 5-line simplified takeaway
            const beginnerSummary = generateBeginnerSummary(name, categoryType, context, industry, overview, attributes, comparisons);
            
            return {
                overview: overview,
                attributes: attributes,
                technicalDetails: technicalDetails,
                dimensions: dimensions,
                steps: steps,
                insight: insight,
                comparisons: comparisons,
                notSuitable: notSuitable,
                aiBlindSpots: aiBlindSpots,
                beginnerSummary: beginnerSummary
            };
        }

        // Format content for beginner view - minimal specs, highlighted recommendations
        function formatBeginnerView(content, productName, categoryType) {
            const beginner = {
                overview: content.overview, // Already simplified
                beginnerRecommendation: content.beginnerRecommendation, // Highlight recommendations
                // Minimal specs - only show 2-3 most important attributes
                attributes: content.attributes.slice(0, 3).map(attr => {
                    // Simplify technical language
                    return attr.replace(/Constructed from materials such as/g, 'Made from')
                               .replace(/Designed with considerations for/g, 'Good for')
                               .replace(/Available in standard sizing options/g, 'Comes in different sizes')
                               .replace(/Material:/g, '')
                               .replace(/Size:/g, '')
                               .replace(/User suitability:/g, '');
                }),
                // Minimal dimensions
                dimensions: content.dimensions.slice(0, 3).map(dim => {
                    return dim.replace(/typically include/g, 'include')
                              .replace(/may be available/g, 'available')
                              .replace(/specifications vary/g, 'options vary');
                }),
                // Simplified usage
                steps: content.steps.slice(0, 3).map(step => {
                    return step.replace(/Employed in/g, 'Used in')
                               .replace(/Utilized for/g, 'Good for')
                               .replace(/Applied in/g, 'Used in')
                               .replace(/Listed in online product catalogs with detailed specifications for customer browsing/g, 'Sold online')
                               .replace(/Displayed in search results with filtering options/g, 'Found in search results')
                               .replace(/Packaged for direct-to-consumer shipping/g, 'Shipped to customers');
                }),
                // Simplified AI blind spots
                aiBlindSpots: content.aiBlindSpots.slice(0, 3).map(bs => ({
                    blindspot: bs.blindspot.replace(/proper sizing requirements/g, 'getting the right size')
                                           .replace(/maintenance requirements/g, 'taking care of it'),
                    why: bs.why.replace(/AI systems focus on/g, 'AI focuses on')
                               .replace(/AI descriptions emphasize/g, 'AI talks about'),
                    consequence: bs.consequence.replace(/Users may/g, 'You might')
                                               .replace(/Equipment may/g, 'It might')
                                               .replace(/Products may/g, 'It might')
                })),
                // Minimal not suitable list
                notSuitable: content.notSuitable.slice(0, 2).map(item => {
                    return item.replace(/Users who require/g, 'Not for people who need')
                                .replace(/Environments with/g, 'Not for places with')
                                .replace(/Individuals with/g, 'Not for people with');
                }),
                // Simplified comparisons - no trade-offs
                comparisons: content.comparisons.slice(0, 1).map(comp => ({
                    title: comp.title.replace(/Budget vs Premium/g, 'Cheap vs Expensive'),
                    content: comp.content.replace(/Cost-effective options/g, 'Cheaper options')
                                         .replace(/Premium variants/g, 'Expensive versions')
                                         .replace(/initial cost/g, 'price')
                                         .substring(0, 150) + '...' // Limit length
                })),
                beginnerSummary: content.beginnerSummary
            };
            return beginner;
        }

        // Format content for expert view - full specs, trade-offs, usage constraints
        function formatExpertView(content, productName, categoryType, context, industry) {
            const expert = {
                overview: content.overview + (industry !== 'General / Consumer' ? ` For ${industry} operations, consider scalability, compliance requirements, and operational efficiency.` : ''),
                // Full specifications
                attributes: [
                    ...content.attributes,
                    ...(content.technicalDetails || []),
                    'Technical specifications and performance metrics',
                    'Material composition and construction details',
                    'Compatibility and integration requirements',
                    'Maintenance schedules and service intervals',
                    'Performance benchmarks and limitations',
                    'Environmental operating conditions and constraints',
                    'Certification and compliance standards'
                ],
                // Full dimensions with technical details
                dimensions: [
                    ...content.dimensions,
                    'Precise measurements and tolerances',
                    'Weight distribution and balance specifications',
                    'Compatibility with standard accessories or components',
                    'Custom configuration options and variants',
                    'Dimensional constraints and space requirements',
                    'Weight limits and capacity specifications'
                ],
                // Full usage scenarios with constraints
                steps: content.steps.map(step => {
                    let enhanced = step;
                    // Add usage constraints
                    if (step.includes('online') || step.includes('shipping')) {
                        enhanced += ' (Constraints: packaging requirements, shipping regulations, delivery timeframes)';
                    } else if (step.includes('warehouse') || step.includes('storage')) {
                        enhanced += ' (Constraints: storage capacity, handling equipment requirements, environmental conditions)';
                    } else if (step.includes('manufacturing') || step.includes('production')) {
                        enhanced += ' (Constraints: production line compatibility, quality control requirements, throughput limitations)';
                    } else {
                        enhanced += ' (Technical considerations: performance metrics, efficiency ratings, and operational parameters)';
                    }
                    return enhanced;
                }),
                aiBlindSpots: [
                    ...content.aiBlindSpots,
                    {
                        blindspot: 'technical specifications and performance trade-offs',
                        why: 'AI systems provide generic descriptions without detailed technical analysis',
                        consequence: 'Users may select products with incompatible specifications or performance limitations'
                    },
                    {
                        blindspot: 'maintenance requirements and total cost of ownership',
                        why: 'AI focuses on initial purchase rather than long-term operational costs',
                        consequence: 'Hidden costs from maintenance, replacement parts, and service intervals may significantly exceed initial price'
                    },
                    {
                        blindspot: 'performance degradation and lifespan under specific conditions',
                        why: 'AI descriptions assume ideal conditions without addressing real-world usage patterns',
                        consequence: 'Products may fail prematurely or underperform in actual operating environments'
                    }
                ],
                notSuitable: [
                    ...content.notSuitable,
                    'Applications requiring specific technical certifications or compliance standards',
                    'High-performance environments where specifications do not meet requirements',
                    'Systems requiring precise integration with existing technical infrastructure',
                    'Operations with strict performance benchmarks that the product cannot achieve'
                ],
                // Full trade-offs and usage constraints
                comparisons: [
                    ...content.comparisons,
                    {
                        title: 'Performance vs Cost Trade-offs',
                        content: `Evaluate total cost of ownership including training, maintenance, and downtime. Standard options may require more staff time but lower upfront costs. Enterprise solutions offer better efficiency but require significant investment and change management. Usage constraint: Budget limitations may restrict feature access or scalability options.`
                    },
                    {
                        title: 'Compliance and Risk Considerations',
                        content: `Standard products may meet basic requirements but lack certifications needed for regulated industries. Premium options often include compliance documentation, audit trails, and regulatory support but at higher cost. Usage constraint: Non-compliant products may face legal restrictions or operational limitations in regulated environments.`
                    },
                    {
                        title: 'Scalability and Capacity Constraints',
                        content: `Entry-level options may have capacity limitations that require upgrades as usage grows. Mid-range solutions balance current needs with future growth potential. Premium options offer maximum scalability but may include unused capacity costs. Usage constraint: Exceeding capacity limits may result in performance degradation or service interruptions.`
                    },
                    {
                        title: 'Integration and Compatibility Constraints',
                        content: `Products may require specific software versions, hardware configurations, or network setups. Compatibility issues can create integration challenges with existing systems. Usage constraint: Incompatible systems may require additional middleware, custom development, or system modifications.`
                    }
                ],
                beginnerSummary: [
                    content.beginnerSummary[0],
                    `For expert use, evaluate technical specifications, performance benchmarks, and integration requirements.`,
                    `Consider total cost of ownership including training, maintenance, and potential downtime.`,
                    `Assess vendor support quality, warranty terms, and supply chain reliability.`,
                    `Review usage constraints, compatibility requirements, and scalability limitations.`,
                    `Bottom line: Ensure the product aligns with your technical requirements, compliance needs, and operational constraints.`
                ]
            };
            return expert;
        }

        // Display product information
        // Generate AI misses data based on product category
        function generateAIMisses(productName, categoryType) {
            const nameLower = productName.toLowerCase();
            const misses = [];
            
            // Cricket Bat specific misses
            if (nameLower.includes('cricket bat') || nameLower.includes('bat')) {
                misses.push({
                    icon: 'üìè',
                    title: 'Wrong bat size for player height',
                    explanation: 'Generic AI doesn\'t explain that bat length should match player height. Too long causes poor control, too short limits reach.'
                });
                misses.push({
                    icon: '‚öñÔ∏è',
                    title: 'Weight causing wrist injury',
                    explanation: 'AI descriptions rarely mention that heavy bats (1.3kg+) can cause wrist strain for players under 16 or those with weaker wrists.'
                });
                misses.push({
                    icon: 'üèè',
                    title: 'Using tennis bat for leather ball',
                    explanation: 'Most AI doesn\'t warn that tennis ball bats lack the durability needed for leather balls, leading to quick damage and safety risks.'
                });
                misses.push({
                    icon: 'üíß',
                    title: 'Storage and moisture damage',
                    explanation: 'AI explanations often skip that willow bats must be stored in dry conditions. Moisture causes warping and reduces performance significantly.'
                });
            }
            // Safety Gloves
            else if (nameLower.includes('glove') || nameLower.includes('safety')) {
                misses.push({
                    icon: '‚úã',
                    title: 'Wrong glove size reduces protection',
                    explanation: 'AI doesn\'t emphasize that loose gloves can catch on machinery, while tight gloves reduce dexterity and cause fatigue.'
                });
                misses.push({
                    icon: 'üß™',
                    title: 'Material compatibility with chemicals',
                    explanation: 'Generic AI often misses that different glove materials react differently to specific chemicals, causing degradation or failure.'
                });
                misses.push({
                    icon: '‚è±Ô∏è',
                    title: 'Replacement frequency overlooked',
                    explanation: 'AI descriptions rarely mention that gloves degrade over time even without visible damage, requiring regular replacement for safety.'
                });
            }
            // Forklift
            else if (nameLower.includes('forklift')) {
                misses.push({
                    icon: 'üîã',
                    title: 'Battery capacity vs shift length',
                    explanation: 'AI doesn\'t explain that electric forklifts need battery capacity matching shift duration, or you\'ll face mid-shift downtime.'
                });
                misses.push({
                    icon: 'üèóÔ∏è',
                    title: 'Floor load capacity requirements',
                    explanation: 'Most AI misses that warehouse floors must support forklift weight plus load. Weak floors cause structural damage over time.'
                });
                misses.push({
                    icon: 'üå°Ô∏è',
                    title: 'Indoor vs outdoor operation limits',
                    explanation: 'AI rarely clarifies that electric forklifts are indoor-only, while diesel/LPG models have ventilation requirements for indoor use.'
                });
            }
            // General/Default
            else {
                misses.push({
                    icon: 'üìê',
                    title: 'Size and fit considerations',
                    explanation: 'Generic AI often provides dimensions but doesn\'t explain how improper sizing affects performance, safety, or usability.'
                });
                misses.push({
                    icon: '‚öôÔ∏è',
                    title: 'Maintenance requirements',
                    explanation: 'AI descriptions frequently skip ongoing maintenance needs, replacement parts, or service intervals that impact long-term costs.'
                });
                misses.push({
                    icon: 'üåç',
                    title: 'Environmental compatibility',
                    explanation: 'Most AI doesn\'t mention how temperature, humidity, or environmental conditions affect product performance or lifespan.'
                });
                misses.push({
                    icon: 'üë•',
                    title: 'User skill level requirements',
                    explanation: 'AI explanations often miss that some products require specific training or experience to use safely and effectively.'
                });
            }
            
            return misses;
        }

        // Display AI misses section
        function displayAIMisses(productName, categoryType) {
            const aiMissesSection = document.getElementById('aiMissesSection');
            const aiMissesGrid = document.getElementById('aiMissesGrid');
            
            if (!aiMissesSection || !aiMissesGrid) return;
            
            const misses = generateAIMisses(productName, categoryType);
            
            if (misses.length === 0) {
                aiMissesSection.style.display = 'none';
                return;
            }
            
            aiMissesGrid.innerHTML = '';
            
            misses.forEach(miss => {
                const card = document.createElement('div');
                card.className = 'ai-miss-card';
                card.innerHTML = `
                    <div class="ai-miss-icon">${miss.icon}</div>
                    <div class="ai-miss-content">
                        <div class="ai-miss-title">${miss.title}</div>
                        <div class="ai-miss-explanation">${miss.explanation}</div>
                    </div>
                `;
                aiMissesGrid.appendChild(card);
            });
            
            aiMissesSection.style.display = 'block';
        }

        function displayProductInfo(productName, context = {}, view = 'beginner') {
            if (!productName.trim()) {
                // Hide all sections if input is empty
                document.querySelectorAll('.content-section').forEach(section => {
                    section.classList.remove('active');
                });
                document.getElementById('viewToggleSection').classList.remove('active');
                document.getElementById('clarificationSection').classList.remove('active');
                document.getElementById('exportSection').classList.remove('active');
                const aiMissesSection = document.getElementById('aiMissesSection');
                if (aiMissesSection) aiMissesSection.style.display = 'none';
                currentProductName = '';
                currentContent = null;
                return;
            }

            const content = generateContent(productName, context);
            
            // Store for export
            currentProductName = productName;
            currentContent = content;
            currentView = view;
            
            // Format content based on view
            const nameLower = productName.toLowerCase();
            let categoryType = 'general';
            if (nameLower.match(/\b(ball|racket|bat|helmet|glove|shoe|sneaker|equipment|fitness|sport|athletic|gym|workout)\b/)) {
                categoryType = 'sports';
            } else if (nameLower.match(/\b(food|snack|cereal|beverage|drink|ingredient|organic|natural|nutrition|meal|recipe)\b/)) {
                categoryType = 'food';
            } else if (nameLower.match(/\b(phone|tablet|laptop|computer|device|electronic|tech|charger|cable|battery|screen|display|gadget)\b/)) {
                categoryType = 'electronics';
            } else if (nameLower.match(/\b(shirt|pants|dress|jacket|clothing|apparel|fabric|textile|garment|wear)\b/)) {
                categoryType = 'clothing';
            }
            
            // Show "What Generic AI Often Misses" section FIRST (before other content)
            displayAIMisses(productName, categoryType);
            
            // Show view toggle
            document.getElementById('viewToggleSection').classList.add('active');
            
            const displayContent = view === 'beginner' 
                ? formatBeginnerView(content, productName, categoryType)
                : formatExpertView(content, productName, categoryType, context, context.industry || 'General / Consumer');
            
            // Show Product Overview
            document.getElementById('overviewText').textContent = displayContent.overview;
            setTimeout(() => {
                document.getElementById('productOverview').classList.add('active');
                // Auto-scroll to analysis output
                setTimeout(() => {
                    document.getElementById('productOverview').scrollIntoView({ 
                        behavior: 'smooth', 
                        block: 'start' 
                    });
                }, 100);
            }, 50);
            
            // Show Beginner Recommendation (only in Beginner View) - Highlight recommendations
            const beginnerRecommendationSection = document.getElementById('beginnerRecommendation');
            const recommendationCard = beginnerRecommendationSection.querySelector('.decision-card');
            if (view === 'beginner' && displayContent.beginnerRecommendation) {
                document.getElementById('beginnerRecommendationText').textContent = displayContent.beginnerRecommendation;
                beginnerRecommendationSection.style.display = 'block';
                if (recommendationCard) {
                    recommendationCard.classList.add('highlighted-recommendation');
                }
                setTimeout(() => {
                    beginnerRecommendationSection.classList.add('active');
                }, 75);
            } else {
                beginnerRecommendationSection.style.display = 'none';
                beginnerRecommendationSection.classList.remove('active');
                if (recommendationCard) {
                    recommendationCard.classList.remove('highlighted-recommendation');
                }
            }
            
            // Show Key Attributes / Specifications
            const attributesList = document.getElementById('attributesList');
            attributesList.innerHTML = '';
            displayContent.attributes.forEach(attr => {
                const li = document.createElement('li');
                li.textContent = attr;
                attributesList.appendChild(li);
            });
            
            // Show/hide technical details toggle
            const technicalToggle = document.getElementById('technicalToggle');
            const technicalDetails = document.getElementById('technicalDetails');
            const technicalList = document.getElementById('technicalList');
            
            if (content.technicalDetails && content.technicalDetails.length > 0) {
                technicalToggle.style.display = 'flex';
                technicalList.innerHTML = '';
                content.technicalDetails.forEach(detail => {
                    const li = document.createElement('li');
                    li.textContent = detail;
                    technicalList.appendChild(li);
                });
                technicalDetails.style.display = 'none'; // Hidden by default
                technicalToggle.classList.remove('expanded');
                technicalToggle.querySelector('.toggle-text').textContent = 'Show technical details (optional)';
            } else {
                technicalToggle.style.display = 'none';
                technicalDetails.style.display = 'none';
            }
            
            setTimeout(() => {
                document.getElementById('keyAttributes').classList.add('active');
            }, 100);
            
            // Show Variants & Options
            const variantsList = document.getElementById('variantsList');
            variantsList.innerHTML = '';
            displayContent.dimensions.forEach(dim => {
                const li = document.createElement('li');
                li.textContent = dim;
                variantsList.appendChild(li);
            });
            setTimeout(() => {
                document.getElementById('variantsOptions').classList.add('active');
            }, 150);
            
            // Show Real-World Usage Scenarios
            const usageScenariosList = document.getElementById('usageScenariosList');
            usageScenariosList.innerHTML = '';
            displayContent.steps.forEach(step => {
                const li = document.createElement('li');
                li.textContent = step;
                usageScenariosList.appendChild(li);
            });
            setTimeout(() => {
                document.getElementById('realWorldUsage').classList.add('active');
            }, 200);
            
            // Show AI Insight: What Typical AI Misses (Blind Spots)
            const aiInsightContainer = document.getElementById('aiInsightBlindspots');
            aiInsightContainer.innerHTML = '';
            
            const blindSpots = displayContent.aiBlindSpots || content.aiBlindSpots || [];
            blindSpots.forEach(blindspot => {
                const blindspotDiv = document.createElement('div');
                blindspotDiv.className = 'ai-blindspot';
                
                const title = document.createElement('div');
                title.className = 'ai-blindspot-title';
                title.textContent = `Most AI descriptions ignore ${blindspot.blindspot}.`;
                
                const reason = document.createElement('div');
                reason.className = 'ai-blindspot-reason';
                reason.textContent = `Why: ${blindspot.why}`;
                
                const consequence = document.createElement('div');
                consequence.className = 'ai-blindspot-consequence';
                consequence.textContent = `In real usage, this causes ${blindspot.consequence}`;
                
                blindspotDiv.appendChild(title);
                blindspotDiv.appendChild(reason);
                blindspotDiv.appendChild(consequence);
                aiInsightContainer.appendChild(blindspotDiv);
            });
            
            // Show "Who This Product Is NOT Suitable For"
            const notSuitableList = document.getElementById('notSuitableList');
            notSuitableList.innerHTML = '';
            displayContent.notSuitable.forEach(item => {
                const li = document.createElement('li');
                li.textContent = item;
                notSuitableList.appendChild(li);
            });
            
            setTimeout(() => {
                document.getElementById('aiInsight').classList.add('active');
            }, 250);
            
            // Show Comparison Insight (visual cards)
            const comparisonCardsContainer = document.getElementById('comparisonCards');
            const comparisonTextContainer = document.getElementById('comparisonText');
            comparisonCardsContainer.innerHTML = '';
            comparisonTextContainer.innerHTML = '';
            
            // Generate visual comparisons
            const visualComparisons = generateVisualComparisons(productName, categoryType);
            
            if (visualComparisons.length > 0) {
                // Show visual cards
                visualComparisons.forEach(comparison => {
                    const card = document.createElement('div');
                    card.className = 'comparison-card';
                    
                    const durabilityClass = comparison.durability === 'High' ? 'durability-high' : 
                                          comparison.durability === 'Medium' ? 'durability-medium' : 'durability-low';
                    const beginnerClass = comparison.beginnerFriendly === 'Yes' ? 'beginner-friendly-yes' : 'beginner-friendly-no';
                    
                    card.innerHTML = `
                        <div class="comparison-card-image" style="background-image: url('${comparison.image}');"></div>
                        <div class="comparison-card-content">
                            <div class="comparison-card-title">${comparison.title}</div>
                            <div class="comparison-card-detail">
                                <span class="comparison-card-detail-label">Best for:</span>
                                <span class="comparison-card-detail-value">${comparison.bestFor}</span>
                            </div>
                            <div class="comparison-card-detail">
                                <span class="comparison-card-detail-label">Durability:</span>
                                <span class="comparison-card-detail-value">
                                    <span class="durability-badge ${durabilityClass}">${comparison.durability}</span>
                                </span>
                            </div>
                            <div class="comparison-card-detail">
                                <span class="comparison-card-detail-label">Beginner friendly:</span>
                                <span class="comparison-card-detail-value ${beginnerClass}">${comparison.beginnerFriendly}</span>
                            </div>
                        </div>
                    `;
                    comparisonCardsContainer.appendChild(card);
                });
            } else {
                // Fallback to text-based comparisons if no visual data
                const comparisonList = document.createElement('ul');
                comparisonList.className = 'card-bullets';
                displayContent.comparisons.forEach(comparison => {
                    const li = document.createElement('li');
                    li.innerHTML = `<strong>${comparison.title}:</strong> ${comparison.content}`;
                    comparisonList.appendChild(li);
                });
                comparisonTextContainer.appendChild(comparisonList);
                comparisonTextContainer.style.display = 'block';
            }
            
            setTimeout(() => {
                document.getElementById('comparisonInsight').classList.add('active');
            }, 300);
            
            // Show Beginner Summary (with delay for soft animation)
            const beginnerSummaryContainer = document.getElementById('beginnerSummaryText');
            beginnerSummaryContainer.innerHTML = '';
            displayContent.beginnerSummary.forEach(item => {
                const li = document.createElement('li');
                li.textContent = item;
                beginnerSummaryContainer.appendChild(li);
            });
            
            // Add beginner summary last with slight delay for soft animation
            setTimeout(() => {
                document.getElementById('beginnerSummary').classList.add('active');
            }, 400);
            
            // Show export section
            document.getElementById('exportSection').classList.add('active');
        }

        // Format content for text export
        function formatContentForExport(productName, content) {
            let text = `PRODUCT INTELLIGENCE REPORT\n`;
            text += `Product: ${productName}\n`;
            text += `Generated: ${new Date().toLocaleString()}\n`;
            text += `\n${'='.repeat(60)}\n\n`;
            
            text += `1. PRODUCT OVERVIEW\n`;
            text += `${'-'.repeat(60)}\n`;
            text += `${content.overview}\n\n`;
            
            text += `2. KEY ATTRIBUTES / SPECIFICATIONS\n`;
            text += `${'-'.repeat(60)}\n`;
            content.attributes.forEach((attr, index) => {
                text += `${index + 1}. ${attr}\n`;
            });
            text += `\n`;
            
            text += `3. VARIANTS & OPTIONS\n`;
            text += `${'-'.repeat(60)}\n`;
            content.dimensions.forEach((dim, index) => {
                text += `${index + 1}. ${dim}\n`;
            });
            text += `\n`;
            
            text += `4. REAL-WORLD USAGE SCENARIOS\n`;
            text += `${'-'.repeat(60)}\n`;
            content.steps.forEach((step, index) => {
                text += `${index + 1}. ${step}\n`;
            });
            text += `\n`;
            
            text += `5. AI INSIGHT: WHAT TYPICAL AI MISSES\n`;
            text += `${'-'.repeat(60)}\n`;
            if (content.aiBlindSpots && content.aiBlindSpots.length > 0) {
                content.aiBlindSpots.forEach((blindspot, index) => {
                    text += `\n${index + 1}. Most AI descriptions ignore ${blindspot.blindspot}.\n`;
                    text += `   Why: ${blindspot.why}\n`;
                    text += `   In real usage, this causes ${blindspot.consequence}\n`;
                });
            } else {
                text += `${content.insight}\n`;
            }
            text += `\n`;
            
            text += `WHO THIS PRODUCT IS NOT SUITABLE FOR\n`;
            text += `${'-'.repeat(60)}\n`;
            content.notSuitable.forEach((item, index) => {
                text += `${index + 1}. ${item}\n`;
            });
            text += `\n`;
            
            text += `6. COMPARISON INSIGHT\n`;
            text += `${'-'.repeat(60)}\n`;
            content.comparisons.forEach((comparison, index) => {
                text += `${comparison.title}\n`;
                text += `${comparison.content}\n\n`;
            });
            
            text += `7. BEGINNER SUMMARY\n`;
            text += `${'-'.repeat(60)}\n`;
            content.beginnerSummary.forEach((item, index) => {
                text += `${index + 1}. ${item}\n`;
            });
            text += `\n`;
            
            text += `\n${'='.repeat(60)}\n`;
            text += `This is an early-stage Product Intelligence MVP using illustrative data. The platform demonstrates structured decision-support logic, not generic AI content generation.\n`;
            
            return text;
        }

        // Copy to clipboard
        function copyToClipboard(productName, content) {
            const text = formatContentForExport(productName, content);
            
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(text).then(() => {
                    const feedback = document.getElementById('copyFeedback');
                    feedback.classList.add('show');
                    setTimeout(() => {
                        feedback.classList.remove('show');
                    }, 2000);
                }).catch(err => {
                    console.error('Failed to copy:', err);
                    alert('Failed to copy to clipboard. Please try the export as text option.');
                });
            } else {
                // Fallback for older browsers
                const textarea = document.createElement('textarea');
                textarea.value = text;
                textarea.style.position = 'fixed';
                textarea.style.opacity = '0';
                document.body.appendChild(textarea);
                textarea.select();
                try {
                    document.execCommand('copy');
                    const feedback = document.getElementById('copyFeedback');
                    feedback.classList.add('show');
                    setTimeout(() => {
                        feedback.classList.remove('show');
                    }, 2000);
                } catch (err) {
                    alert('Failed to copy to clipboard. Please try the export as text option.');
                }
                document.body.removeChild(textarea);
            }
        }

        // Export as text file
        function exportAsText(productName, content) {
            const text = formatContentForExport(productName, content);
            const blob = new Blob([text], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `product-intelligence-${productName.replace(/[^a-z0-9]/gi, '-').toLowerCase()}-${Date.now()}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Print / PDF export
        function exportAsPDF(productName) {
            window.print();
        }

        // Event listener for input - autocomplete
        const productInput = document.getElementById('productInput');
        
        productInput.addEventListener('input', function() {
            const query = this.value.trim();
            
            if (!query) {
                document.getElementById('autocompleteDropdown').classList.remove('active');
                document.getElementById('categorySection').classList.remove('active');
                document.querySelectorAll('.content-section').forEach(section => {
                    section.classList.remove('active');
                });
                document.getElementById('exportSection').classList.remove('active');
                document.getElementById('viewToggleSection').classList.remove('active');
                selectedProduct = null;
                return;
            }
            
            // Show autocomplete after 2 characters
            if (query.length >= 2) {
                showAutocompleteSuggestions(query);
            } else {
                document.getElementById('autocompleteDropdown').classList.remove('active');
            }
        });

        // Handle Enter key - try to select first suggestion or show error
        productInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && this.value.trim()) {
                e.preventDefault();
                const query = this.value.trim().toLowerCase();
                const suggestions = getProductSuggestions(query);
                
                if (suggestions.length > 0) {
                    selectProduct(suggestions[0].key);
                } else {
                    // No suggestions found - product not supported
                    this.value = '';
                    this.placeholder = 'This product category is not supported in the current MVP.';
                    this.style.borderColor = '#ef4444';
                    this.style.backgroundColor = '#fef2f2';
                    
                    // Reset after 3 seconds
                    setTimeout(() => {
                        this.placeholder = 'Search for a product (e.g. Cricket Bat, Forklift, Safety Gloves)';
                        this.style.borderColor = '';
                        this.style.backgroundColor = '';
                    }, 3000);
                    
                    // Hide autocomplete
                    document.getElementById('autocompleteDropdown').classList.remove('active');
                }
            }
        });

        // Close autocomplete when clicking outside
        document.addEventListener('click', function(e) {
            const inputSection = document.querySelector('.input-section');
            if (!inputSection.contains(e.target)) {
                document.getElementById('autocompleteDropdown').classList.remove('active');
            }
        });

        // Optional clarification section expand/collapse
        const clarificationHeader = document.getElementById('clarificationHeader');
        const clarificationContent = document.getElementById('clarificationContent');
        const clarificationToggle = document.getElementById('clarificationToggle');

        clarificationHeader.addEventListener('click', function() {
            const isExpanded = clarificationContent.classList.contains('expanded');
            if (isExpanded) {
                clarificationContent.classList.remove('expanded');
                clarificationToggle.classList.remove('expanded');
            } else {
                clarificationContent.classList.add('expanded');
                clarificationToggle.classList.add('expanded');
                // Populate questions when expanded
                if (productInput.value.trim()) {
                    showClarificationQuestions(productInput.value);
                }
            }
        });

        // Update showClarificationQuestions to not require button clicks
        function showClarificationQuestions(productName) {
            const nameLower = productName.toLowerCase().trim();
            let categoryType = 'general';
            
            if (nameLower.match(/\b(ball|racket|bat|helmet|glove|shoe|sneaker|equipment|fitness|sport|athletic|gym|workout)\b/)) {
                categoryType = 'sports';
            } else if (nameLower.match(/\b(food|snack|cereal|beverage|drink|ingredient|organic|natural|nutrition|meal|recipe)\b/)) {
                categoryType = 'food';
            } else if (nameLower.match(/\b(phone|tablet|laptop|computer|device|electronic|tech|charger|cable|battery|screen|display|gadget)\b/)) {
                categoryType = 'electronics';
            } else if (nameLower.match(/\b(shirt|pants|dress|jacket|clothing|apparel|fabric|textile|garment|wear)\b/)) {
                categoryType = 'clothing';
            }

            const questions = generateQuestions(categoryType, productName);
            const container = document.getElementById('questionsContainer');
            container.innerHTML = '';

            questions.forEach((q, index) => {
                const group = document.createElement('div');
                group.className = 'question-group';
                
                const label = document.createElement('label');
                label.textContent = `${index + 1}. ${q.label}:`;
                group.appendChild(label);

                if (q.type === 'select') {
                    const select = document.createElement('select');
                    select.id = q.id;
                    select.name = q.id;
                    const defaultOption = document.createElement('option');
                    defaultOption.value = '';
                    defaultOption.textContent = '-- Select --';
                    select.appendChild(defaultOption);
                    q.options.forEach(opt => {
                        const option = document.createElement('option');
                        option.value = opt;
                        option.textContent = opt;
                        select.appendChild(option);
                    });
                    group.appendChild(select);
                } else {
                    const input = document.createElement('input');
                    input.type = 'text';
                    input.id = q.id;
                    input.name = q.id;
                    input.placeholder = q.placeholder || '';
                    group.appendChild(input);
                }

                container.appendChild(group);
            });
        }

        // Export button event listeners
        document.getElementById('copyBtn').addEventListener('click', function() {
            if (currentProductName && currentContent) {
                copyToClipboard(currentProductName, currentContent);
            }
        });

        document.getElementById('exportTextBtn').addEventListener('click', function() {
            if (currentProductName && currentContent) {
                exportAsText(currentProductName, currentContent);
            }
        });

        document.getElementById('exportPdfBtn').addEventListener('click', function() {
            if (currentProductName) {
                exportAsPDF(currentProductName);
            }
        });

        // Technical details toggle
        const technicalToggle = document.getElementById('technicalToggle');
        if (technicalToggle) {
            technicalToggle.addEventListener('click', function() {
                const technicalDetails = document.getElementById('technicalDetails');
                const isExpanded = technicalDetails.style.display === 'block';
                
                if (isExpanded) {
                    technicalDetails.style.display = 'none';
                    this.classList.remove('expanded');
                    this.querySelector('.toggle-text').textContent = 'Show technical details';
                } else {
                    technicalDetails.style.display = 'block';
                    this.classList.add('expanded');
                    this.querySelector('.toggle-text').textContent = 'Hide technical details';
                }
            });
        }

        // Roadmap expandable section
        const roadmapHeader = document.getElementById('roadmapHeader');
        const roadmapContent = document.getElementById('roadmapContent');
        const roadmapToggle = document.getElementById('roadmapToggle');

        roadmapHeader.addEventListener('click', function() {
            const isExpanded = roadmapContent.classList.contains('expanded');
            if (isExpanded) {
                roadmapContent.classList.remove('expanded');
                roadmapToggle.classList.remove('expanded');
            } else {
                roadmapContent.classList.add('expanded');
                roadmapToggle.classList.add('expanded');
            }
        });

        // View toggle event listeners
        const beginnerViewBtn = document.getElementById('beginnerViewBtn');
        const expertViewBtn = document.getElementById('expertViewBtn');

        beginnerViewBtn.addEventListener('click', function() {
            if (currentProductName) {
                currentView = 'beginner';
                beginnerViewBtn.classList.add('active');
                expertViewBtn.classList.remove('active');
                const clarificationContent = document.getElementById('clarificationContent');
                const context = clarificationContent.classList.contains('expanded') 
                    ? collectContextAnswers() 
                    : contextAnswers;
                displayProductInfo(currentProductName, context, 'beginner');
            }
        });

        expertViewBtn.addEventListener('click', function() {
            if (currentProductName) {
                currentView = 'expert';
                expertViewBtn.classList.add('active');
                beginnerViewBtn.classList.remove('active');
                const clarificationContent = document.getElementById('clarificationContent');
                const context = clarificationContent.classList.contains('expanded') 
                    ? collectContextAnswers() 
                    : contextAnswers;
                displayProductInfo(currentProductName, context, 'expert');
            }
        });
    </script>
</body>
</html>

